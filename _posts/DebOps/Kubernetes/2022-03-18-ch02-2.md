---
title:  "[KUBERNETES] 06. μΏ λ²„λ„¤ν‹°μ¤μ μ¤λΈμ νΈ (2)" 

categories:
  - KUBERNETES
tags:
  - [kubernetes]

toc: true
toc_sticky: true

date: 2022-03-18
last_modified_at: 2022-03-18
---
# [KUBERNETES] 05. μΏ λ²„λ„¤ν‹°μ¤μ μ¤λΈμ νΈ (2)
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
</style>

<br>

## π”” μ»¨νΈλ΅¤λ¬ (Controller)

> κΈ°λ³Έ μ¤λΈμ νΈ(Basic Object)λ¥Ό μΆ€ λ” νΈλ¦¬ν•κ² κ΄€λ¦¬ν•κΈ° μ„ν•΄ μ‚¬μ©ν•λ” μ¤λΈμ νΈ

<br>

### π“ λ¦¬ν”λ¦¬μΉ΄μ…‹(ReplicaSet)

> λ¦¬ν”λ¦¬μΉ΄μ…‹μ€ μ‹¤ν–‰λλ” νλ“(Pod)μ κ°μμ— λ€ν• κ°€μ©μ„±μ„ λ³΄μ¦ν•λ©°, μ§€μ •ν• νλ“μ κ°μ λ§νΌ ν•­μƒ μ‹¤ν–‰λ  μ μλ„λ΅ κ΄€λ¦¬ν•λ” μ—­ν• 

- μ¦‰, 5κ°μ νλ“λ¥Ό ν•­μƒ μ‹¤ν–‰ν•λ„λ΅ μ„¤μ •ν•λ©΄ μ΄ν›„ μ–΄λ– ν• μ΄μ λ΅ νλ“κ°€ λΉ„μ •μƒ μΆ…λ£ λλ” μ‚­μ  λ  κ²½μ° μƒλ΅μ΄ νλ“λ¥Ό μ‹¤ν–‰μ‹μΌ 5κ°λ¥Ό μ μ§€ν•  μ μλ„λ΅ ν•΄μ¤€λ‹¤.

<br>

### π“ λ””ν”λ΅μ΄λ¨ΌνΈ(Deployment)

> λ¦¬ν”λ¦¬μΉ΄μ…‹μ„ YAML νμΌμ— μ‚¬μ©ν•λ” κ²½μ°λ” κ±°μ μ—†κ³ , λ€λ¶€λ¶„ λ¦¬ν”λ¦¬μΉ΄μ…‹κ³Ό νλ“μ μ •λ³΄λ¥Ό μ •μν•λ” λ””ν”λ΅μ΄λ¨ΌνΈλΌλ” μ΄λ¦„μ μ¤λΈμ νΈλ¥Ό μ •μν•΄μ„ μ‚¬μ©ν•λ‹¤.<br><br>
**λ””ν”λ΅μ΄λ¨ΌνΈλ” λ¦¬ν”λ¦¬μΉ΄μ…‹ λ³΄λ‹¤ μƒμ„μ— ν•΄λ‹Ήν•λ” κ°λ…**μΌλ΅ λ¦¬ν”λ¦¬μΉ΄μ…‹μ„ λ‘κ°™μ€ νλ“μ™€ λ¦¬ν”λ¦¬μΉ΄λ¥Ό κ΄€λ¦¬ λ° μ μ–΄ν•λ” λ¦¬μ†μ¤λΌλ©΄ λ””ν”λ΅μ΄λ¨ΌνΈλ” λ¦¬ν”λ¦¬μΉ΄μ…‹μ„ κ΄€λ¦¬ν•κ³  λ‹¤λ£¨κΈ° μ„ν• λ¦¬μ†μ¤λΌκ³  ν•  μ μμΌλ©°, **λ””ν”λ΅μ΄λ¨ΌνΈλ¥Ό μƒμ„±ν•λ©΄ λ¦¬ν”λ¦¬μΉ΄μ…‹λ„ ν•¨κ» μƒμ„±λκΈ° λ•λ¬Έμ— λ””ν”λ΅μ΄λ¨ΌνΈλ” μ• ν”λ¦¬μΌ€μ΄μ… λ°°ν¬μ κΈ°λ³Έ λ‹¨μ„κ°€ λλ‹¤.**

- **λ””ν”λ΅μ΄λ¨ΌνΈμ Deploy λΌλ” λ‹¨μ–΄μ λ»μ΄ λ‚νƒ€λ‚΄λ” κ²ƒμ²λΌ μ»¨ν…μ΄λ„ μ• ν”λ¦¬μΌ€μ΄μ…μ„ λ°°ν¬ν•κ³  κ΄€λ¦¬ν•λ” μ—­ν• **μ„ ν•λ‹¤.

- μλ¥Ό λ“¤μ–΄ μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ—…λ°μ΄νΈν•  λ• λ¦¬ν”λ¦¬μΉ΄μ…‹μ λ³€κ²½ μ‚¬ν•­μ„ μ €μ¥ν•λ” λ¦¬λΉ„μ „(Revision)μ„ λ‚¨κ²¨ λ΅¤λ°±(Rollback)μ„ κ°€λ¥ν•κ² ν•΄μ£Όκ³ , λ¬΄μ¦λ‹¨ μ„λΉ„μ¤λ¥Ό μ„ν•΄ νλ“μ λ΅¤λ§ μ—…λ°μ΄νΈ(Rolling Update)μ μ „λµμ„ μ§€μ •ν•  μ μλ‹¤.

<br>

### π“ μ΅ & ν¬λ΅ μ΅(Job & CronJob)

> **μ΅(Job)μ€ νλ“μ— μλ” λ¨λ“  μ»¨ν…μ΄λ„κ°€ μ •μƒμ μΌλ΅ μΆ…λ£ν•  λ•κΉμ§€ μ¬μ‹¤ν–‰ν•λ” μ»¨νΈλ΅¤λ¬**μ΄λ©°, **ν¬λ΅ μ΅(CronJob)μ€ Unixμ ν¬λ΅ κ³Ό κ°™μ€ ν¬λ§·μΌλ΅ νΉμ •/μ‹κ°„μ— νλ“λ¥Ό μ‹¤ν–‰μ‹ν‚¤λ” λ“± μ§€μ •ν• μΌμ •μ— λ”°λΌ Jobμ„ μ‹¤ν–‰ μ‹ν‚¬ μ μλ” μ»¨νΈλ΅¤λ¬**μ΄λ‹¤.

- **γ€μ΅ μ»¨νΈλ΅¤λ¬μ νΉμ§•γ€‘**

    |νΉμ§•|μ„¤λ…|
    |:---:|---|
    |(1)|μ§€μ •ν• μ‹¤ν–‰ νμμ™€ λ³‘ν–‰ κ°μμ— λ”°λΌ ν• κ° μ΄μƒμ νλ“λ¥Ό μ‹¤ν–‰|
    |(2)|νλ“ λ‚΄μ λ¨λ“  μ»¨ν…μ΄λ„κ°€ μ •μƒ μΆ…λ£ν• κ²½μ°μ—λ§ νλ“λ¥Ό μ •μƒ μΆ…λ£ν• κ²ƒμΌλ΅ μ·¨κΈ‰|
    |(3)|μ΅μ— κΈ°μ ν• νλ“μ μ‹¤ν–‰ νμλ¥Ό μ „λ¶€ μ •μƒ μΆ…λ£ν•λ©΄ μ΅μ€ μΆ…λ£|
    |(4)|κ·Έλ¦¬κ³  νλ“μ λΉ„μ •μƒ μΆ…λ£μ— λ”°λ¥Έ μ¬μ‹¤ν–‰ νμμ μƒν•μ— λ„λ‹¬ν•΄λ„ μ΅μ€ μ¤‘λ‹¨|
    |(5)|λ…Έλ“ μ¥μ•  λ“±μ— μν•΄ μ΅μ νλ“κ°€ μ κ±°λ κ²½μ°, λ‹¤λ¥Έ λ…Έλ“μ—μ„ νλ“λ¥Ό μ¬μ‹¤ν–‰|
    |(6)|μ΅μ— μν•΄ μ‹¤ν–‰λ νλ“λ” μ΅μ΄ μ‚­μ λ  λ•κΉμ§€ μ μ§€|

<br>

### π“ μ¤ν…μ΄νΈν’€μ…‹(StatefulSet)

> κΈ°μ΅΄ λ¦¬ν”λ¦¬μΉ΄μ…‹, λ””ν”λ΅μ΄λ¨ΌνΈλ” λ¨λ‘ μƒνƒκ°€ μ—†λ”(Stateless) νλ“λ“¤μ„ κ΄€λ¦¬ν•λ” μ©λ„ μ€μ§€λ§, **μ¤ν…μ΄νΈν’€μ…‹μ€ λ‹¨μ–΄μ μλ―Έ κ·Έλ€λ΅ μƒνƒλ¥Ό κ°€μ§€κ³  μλ” νλ“λ“¤μ„ κ΄€λ¦¬ν•λ” μ»¨νΈλ΅¤λ¬**μ΄λ‹¤. <br><br>
μ»¨ν…μ΄λ„λ‚ νλ“λ” νƒμƒμ μΌλ΅ λ°μ΄ν„°λ¥Ό λ³΄κ΄€ν•λ” κ²ƒμ΄ μ–΄λ µκΈ° λ•λ¬Έμ— νλ“μ™€ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ„ μ΅°ν•©ν•΄ μ‹¤ν–‰ν•΄μ•Ό ν•κ³  μ΄λ¬ν• μ”κµ¬μ‚¬ν•­μ„ μ„ν•΄ μ¤ν…μ΄νΈν’€μ…‹μ„ μ κ³µν•λ©° **νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ™€ νλ“λ¥Ό ν•¨κ» μ΅°ν•©ν•μ—¬ μ μ–΄ν•κΈ°μ— μ ν•©ν• μ»¨νΈλ΅¤λ¬**μ΄λ‹¤. <br><br>
μ¤ν…μ΄νΈν’€μ…‹μ„ μ‚¬μ©ν•λ©΄ λ³Όλ¥¨μ„ μ‚¬μ©ν•΄μ„ νΉμ • λ°μ΄ν„°λ¥Ό κΈ°λ΅ν•΄λ‘κ³  κ·Έκ±Έ νλ“κ°€ μ¬μ‹μ‘ν–μ„λ•λ„ μ μ§€ν•  μ μλ‹¤.

<br>

#### (a) μ¤ν…μ΄νΈν’€μ…‹κ³Ό λ””ν”λ΅μ΄λ¨ΌνΈ μ°¨μ΄

##### γ€νλ“μ™€ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ μ΄λ¦„γ€‘

μ¤ν…μ΄νΈν’€μ…‹λ„ μ§€μ •ν• λ¦¬ν”λ¦¬μΉ΄ μμ— ν•΄λ‹Ήν•λ” νλ“λ¥Ό νλ“ ν…ν”λ¦Ώμ— κΈ°μ ν• λ‚΄μ©μ— λ”°λΌ κΈ°λ™λλ©° **μ¤ν…μ΄νΈν’€μ…‹μ—μ„λ” νλ“μ™€ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ„ ν•λ‚μ λ‹¨μ„λ΅ μ·¨κΈ‰ν•μ—¬ λ™μΌν• λ²νΈκ°€ μ΄λ¦„μ— λ¶€μ—¬λμ§€λ§, λ””ν”λ΅μ΄λ¨ΌνΈμ κ²½μ° ν•΄μ‹κ°€ λ¶™λ”λ‹¤.**

##### γ€μ„λΉ„μ¤μ™€μ μ—°κ²° λ° μ΄λ¦„ ν•΄κ²°γ€‘

μ¤ν…μ΄νΈν’€μ…‹ κ΄€λ¦¬ν•μ ννΈμ μ”μ²­μ„ μ „μ†΅ν•κΈ° μ„ν• μ„λΉ„μ¤λ” **λ€ν‘ IPλ¥Ό κ°€μ§€μ§€ μ•λ” ClusterIPμ ν—¤λ“λ¦¬μ¤ λ¨λ“λ¥Ό μ‚¬μ©**ν•΄μ•Ό ν•λ‹¤. ν΄λΌμ΄μ–ΈνΈκ°€ μ„λΉ„μ¤μ μ΄λ¦„μΌλ΅ IP μ£Όμ†λ¥Ό ν•΄κ²°ν•λ©΄ μ¤ν…μ΄νΈν’€μ…‹ κ΄€λ¦¬ν•μ νλ“μ IP μ£Όμ†κ°€ λλ¤ν•κ² λ°ν™λλ‹¤.

##### γ€νλ“ λ¶„μ‹¤ μ‹ λ™μ‘γ€‘

**μ¤ν…μ΄νΈν’€μ…‹ κ΄€λ¦¬ν•μ νλ“κ°€ λ…Έλ“ μ¥μ•  λ“±μΌλ΅ μ—†μ–΄μ§„ κ²½μ°, λ™μΌν• μ΄λ¦„μΌλ΅ μƒλ΅­κ² νλ“κ°€ κΈ°λ™λλ©°, μ΄λ• κΈ°μ΅΄ νλ“κ°€ μ‚¬μ©ν–λ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ„ μ΄μ–΄μ„ μ‚¬μ©**ν•λ‹¤. μ£Όμν•  μ μ€, νλ“μ μ΄λ¦„μ΄ κ°™μ•„λ„ νλ“μ IP μ£Όμ†λ” λ³€ν•λ‹¤ κ·Έλμ„ μ¤ν…μ΄νΈν’€μ…‹ κ΄€λ¦¬ν•μ νλ“μ— μ ‘μ†ν•λ” κ²½μ°, λ°λ“μ‹ λ‚΄λ¶€ DNSλ¥Ό μ‚¬μ©ν•΄μ„ μ΄λ¦„μ„ ν•΄κ²°ν•΄μ•Ό ν•λ‹¤.

##### γ€λ…Έλ“ μ •μ§€ μ‹μ λ™μ‘γ€‘

**μ¤ν…μ΄νΈν’€μ…‹μ€ λ°μ΄ν„°λ¥Ό λ¶„μ‹¤ν•μ§€ μ•λ„λ΅ μ„¤κ³„λμ–΄ μμ§€λ§ ν•λ“μ›¨μ–΄, λ„¤νΈμ›ν¬ μ¥μ• λ΅ νΉμ • λ…Έλ“κ°€ μ—°κ²°μ΄ λμ–΄μ΅μ„ λ• μ¤ν…μ΄νΈν’€μ…‹μ€ μƒλ΅μ΄ νλ“λ¥Ό κΈ°λ™ν•μ§€ μ•λ”λ‹¤.** 

κ°€λ Ή, λ…Έλ“μ μƒνƒλ¥Ό κ΄€λ¦¬ν•λ” kubeletκ³Ό λ§μ¤ν„°μ™€μ ν†µμ‹ μ΄ μΌμ‹μ μΌλ΅ λκ²Όμ§€λ§ νλ“λ” κ³„μ†ν•΄μ„ λμ•„κ°€κ³  μλ” κ²½μ°, λ§μ¤ν„°κ°€ λ€μ²΄ νλ“λ¥Ό κΈ°λ™ν•μ—¬ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ„ λ§μ΄νΈν•κ² λλ©΄ μ¤νλ ¤ λ°μ΄ν„°κ°€ νμ†λ  μ μκΈ° λ•λ¬Έμ΄λ‹¤.

νλ“κ°€ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ„ λ§μ΄νΈν•  λ•λ” μ—‘μ„Έμ¤ λ¨λ“λ΅ μ—¬λ¬ λ…Έλ“μ—μ„ μ½κ³ /μ“°κΈ°κ°€ κ°€λ¥ν• ReadWriteMany(RWX)μ™€ ν•λ‚μ λ…Έλ“μ—μ„λ§ μ½κΈ°/μ“°κΈ°ν•  μ μλ” ReadWriteOnce(RWO)λ¥Ό μ‚¬μ©ν•  μ μμ§€λ§, μ΄λ“¤μ€ μ™Έλ¶€ μ¤ν† λ¦¬μ§€ μ‹μ¤ν…μ— μΆ…μ†λ νλΌλ―Έν„°λΌ, NFSμ™€ κ°™μ€ κ³µμ  κ°€λ¥ν• νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ— RWOλ¥Ό μ„¤μ •ν•λ‹¤κ³  ν•΄λ„ μƒλ΅μ΄ νλ“κ°€ κΈ°λ™λλ” κ²ƒμ„ μ–µμ ν•  μ μ—†λ‹¤.

μ¤ν…μ΄νΈν’€μ…‹μ΄ λ¶„μ‹¤λ νλ“λ¥Ό λ‹¤λ¥Έ λ…Έλ“μ—μ„ λ‹¤μ‹ κΈ°λ™ν•λ” κ²½μ°λ” λ‹¤μκ³Ό κ°™λ‹¤.

(1) μ¥μ•  λ…Έλ“λ¥Ό k8s ν΄λ¬μ¤ν„°μ λ§΄λ²„μ—μ„ μ μ™Έν•λ‹¤.<br>
(2) λ¬Έμ κ°€ μλ” νλ“λ¥Ό κ°•μ  μΆ…λ£ν•λ‹¤.<br>
(3) μ¥μ• λ΅ μΈν•΄ μ •μ§€ν• λ…Έλ“λ¥Ό μ¬κΈ°λ™ν•λ‹¤.

##### γ€νλ“ μλ² μ μ–΄γ€‘

μ¤ν…μ΄νΈν’€μ…‹μ νλ“ μ΄λ¦„μ— λ¶™μ€ λ²μλ” νλ“μ κΈ°λ™κ³Ό μ •μ§€λΏλ§ μ•„λ‹λΌ, λ΅¤λ§ μ—…λ°μ΄νΈμ μμ„μ—λ„ μ‚¬μ©λλ‹¤. ν•νΈ, λ””ν”λ΅μ΄λ¨ΌνΈμ—μ„μ νλ“λ…μ€ λ””ν”λ΅μ΄λ¨ΌνΈμ μ΄λ¦„ λ’¤μ— ν•΄μ‹ λ¬Έμμ—΄μ΄ λ¶™μΌλ©° νλ“μ κΈ°λ™ μμ„λ” λλ¤ν•κ² μ μ©λλ‹¤.

(1) μ‹μ‘ν•  λ•λ” νλ“μ™€ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ„ μ§μ§€μ–΄ μ°¨λ΅€λ€λ΅ κΈ°λ™, μ •μ§€ν•  λ•λ” λ²νΈκ°€ ν° μμ„λ΅ μ •μ§€ <br>
(2) λ ν”λ¦¬μΉ΄ κ°’μ„ μ¤„μ΄λ©΄ νλ“ μ΄λ¦„μ λ²νΈκ°€ ν° κ²ƒλ¶€ν„° μ‚­μ  <br>
(3) λ΅¤λ§ μ—…λ°μ΄νΈν•  λ•λ„ νλ“μ μ΄λ¦„μ— λ¶™μ€ λ²νΈμ— λ”°λΌ κ°±μ‹  

<br>

### π“ λ°λ¬μ…‹(DaemonSet)

> **λ°λ¬μ…‹μ€ μΏ λ²„λ„¤ν‹°μ¤λ¥Ό κµ¬μ„±ν•λ” λ¨λ“  λ…Έλ“μ—μ„ νλ“λ¥Ό μ‹¤ν–‰ν•κΈ° μ„ν•΄ μ΅΄μ¬ν•λ” μ»¨νΈλ΅¤λ¬**, μλ¥Ό λ“¤λ©΄ λ¨λ‹ν„°λ§ μ‹μ¤ν… κµ¬μ¶•μ„ μ„ν•΄ λ¨λ“  λ…Έλ“μ— νΉμ • νλ“(λ΅κ·Έ μμ§‘)μ„ κ΄€λ¦¬ν•΄μ•Ό ν•  λ• μ‚¬μ©ν•  μ μλ‹¤. <br><br>
**λ°λ¬μ…‹ κ΄€λ¦¬ν•μ νλ“λ” k8s ν΄λ¬μ¤ν„°μ λ¨λ“  λ…Έλ“μ—μ„ μ‹¤ν–‰λλ”λ° k8s ν΄λ¬μ¤ν„°μ—μ„ λ…Έλ“κ°€ ν•λ‚ μ‚­μ λλ©΄, λ°λ¬μ…‹ κ΄€λ¦¬ν•μ νλ“λ„ κ·Έ λ…Έλ“μ—μ„ μ κ±°λλ‹¤.**<br><br>
λ°λ¬μ…‹μ„ μ‚¬μ©ν•μ—¬ μ „μ²΄ λ…Έλ“κ°€ μ•„λ‹ μΌλ¶€ λ…Έλ“μ—λ§ νλ“λ¥Ό λ°°μΉν•κ³  μ‹¶μ€ κ²½μ°μ—λ” λ…Έλ“ μ…€λ ‰ν„°λ¥Ό μ„¤μ •ν•λ©΄λλ‹¤.

<br>

## π”” μΏ λ²„λ„¤ν‹°μ¤ μ¤λΈμ νΈμ κµ¬μ„±λ„

![κ·Έλ¦Ό (1)](https://user-images.githubusercontent.com/42735894/224765304-6624894b-ff12-4965-9a3e-a768c3c8be6d.png)

![γ…‡γ…γ„΄γ…‡γ„΄γ„·γ…‚γ…γ„·γ…γ…‚](https://user-images.githubusercontent.com/42735894/224765319-a65526ae-67eb-4a26-abd3-30e111c34814.png)

<br>