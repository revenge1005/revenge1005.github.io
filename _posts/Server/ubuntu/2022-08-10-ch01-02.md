---
title:  "[Ubuntu] 02. NTP ì„œë²„ êµ¬ì„±" 

categories:
  - UBUNTU
tags:
  - [ubuntu, linux]

toc: true
toc_sticky: true

date: 2023-05-23
last_modified_at: 2023-05-23
---
<br>

# ğŸ”” íƒ€ì„ ì„œë²„(Time Server) í•„ìš”í•œ ì´ìœ 
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
big {
    font-size: 15pt;
}
</style>

> ì „ì‚°ì‹¤ì—ì„œëŠ” ìˆ˜ë§ì€ ì¥ë¹„ë“¤ì´ ìš´ì˜ë˜ê³  ìˆìœ¼ë©° ê° ì‹œìŠ¤í…œë“¤ì€ ì‹œìŠ¤í…œ ì‹œê°„ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì´ë•Œ ì‹œê°„ì´ ëª¨ë‘ ì¼ì¹˜í•´ì•¼ ê° ì‹œìŠ¤í…œì—ì„œ ìƒì„±ë˜ëŠ” ë°ì´í„°, ë¡œê·¸, ë³´ì•ˆ ë“±ì— ê´€ë ¨ëœ ê²ƒë“¤ì´ ì‹œê°„ì— ëŒ€í•´ ì¼ê´€ì„±ì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ìš´ì˜ë˜ëŠ” ì‹œìŠ¤í…œë“¤ì˜ ì‹œìŠ¤í…œ ì‹œê°„ì´ ë¶ˆì¼ì¹˜í•˜ê²Œ ë˜ë¯€ë¡œ ë™ì¼í•œ ì‹œê°„ì„ ê°€ê¸° ìœ„í•´ ì‹œê°„ ë™ê¸°í™”ë¥¼ í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤2. ì´ë•Œ ì‚¬ìš©ë˜ëŠ” ì„œë²„ê°€ NTP(Network Time Protocol) ì„œë²„ì…ë‹ˆë‹¤.

<br>

# ğŸ”” NTP(Network Time Protocol)
---

> ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì‹œìŠ¤í…œ ì‹œê°„ì„ ë™ê¸°í™” ì‹œí‚¤ëŠ” í†µì‹  í”„ë¡œí† ì½œ ë˜ëŠ” ì„œë¹„ìŠ¤

+ NTPëŠ” ì‹œê°„ë§Œì„ ì²˜ë¦¬í•˜ëŠ” ì›ì ì„œë²„ê°€ ìˆìœ¼ë©° ì´ë¥¼ "Stratum 0"ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

+ ê·¸ë¦¬ê³  NTP ì„œë²„ì™€ ì§ì ‘ ì—°ê²°ëœ NTP ì„œë²„ë¥¼ "Stratum 1"ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

+ "Stratum 1", "Stratum 2", "Stratum 3" ì´ëŸ° í˜•ì‹ìœ¼ë¡œ NTPëŠ” ê³„ì¸µì ì¸ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

+ ì „ì‚°ì‹¤ì— NTP ì„œë²„ë¡œ ì‚¬ìš©í•  ì‹œìŠ¤í…œì„ ë‘ê³  Stratum ì„œë²„ì™€ ì‹œê°„ì„ ë™ê¸°í™” ì„¤ì •ì„ í•˜ê³  ì „ì‚°ì‹¤ ë‚´ì— ìˆëŠ” ëª¨ë“  ì‹œìŠ¤í…œì— NTP ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ì‹œê°„ ë™ê¸°í™”ë¥¼ ì‹œí‚¤ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤.

+ ì´ë ‡ê²Œ í•˜ê¸° ìœ„í•´ì„œëŠ” NTP ì„œë²„/í´ë¼ì´ì–¸íŠ¸ êµ¬ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤.

<br>

<big> **â–  Stratum Server** </big>

|ë„ë©”ì¸|IP ì£¼ì†Œ|ë¹„ê³ |
|:---:|:---:|:---:|
|time.kriss.re.kr|210.98.16.100|Stratum 1, í•œêµ­í‘œì¤€ê³¼í•™ì—°êµ¬ì›|
|time2.kriss.re.kr|210.98.16.101|Stratum 1, í•œêµ­í‘œì¤€ê³¼í•™ì—°êµ¬ì›|
|ntp.postech.ac.kr|141.223.182.106|Stratum 1, í¬í•­ê³µëŒ€|
|ntp.xbsd.pe.kr|58.73.137.250|Stratum 1, xbsd|
|gps.bora.net|210.120.246.46|Stratum 1, LGU+|
|ntp.kornet.net|168.126.3.6|Stratum 1, KT|
|ntp1.cs.pusan.ac.kr|-|Stratum 1, ë¶€ì‚°ëŒ€í•™êµ|
|ntp2.cs.pusan.ac.kr|-|Stratum 1, ë¶€ì‚°ëŒ€í•™êµ|
|ntp.ewha.or.kr|175.119.224.116 / 114.207.245.175 |Stratum 2, ì´í™”ì—¬ëŒ€|
|maths.kaist.ac.kr |143.248.25.208 |Stratum 2, ì¹´ì´ìŠ¤íŠ¸|
|time.bora.net |203.248.240.103 |Stratum 2, LGU+|
|time.korserve.net |211.51.221.196 / 211.51.221.130 |Stratum 2, korserve|
|rokkorclub.net |210.118.170.59 |Stratum 2, rokkorclub|
|time.wonkwang.ac.kr |203.249.48.182 |Stratum 2, ì›ê´‘ëŒ€í•™êµ|
|ntp1.epidc.co.kr |211.115.194.21 |Stratum 2, epidc|
|ntp2.epidc.co.kr |211.115.194.22 |Stratum 2, epidc|
|time.nuri.net |- |Stratum 2, ì•„ì´ë„¤íŠ¸í˜¸ìŠ¤íŒ…|
|cse.inha.ac.kr |165.246.43.176 |Stratum 2, ì¸í•˜ëŒ€í•™êµ|
|radi.inha.ac.kr |165.246.43.195 |Stratum 2, ì¸í•˜ëŒ€í•™êµ|

<br>

# ğŸ”” NTP ì„œë²„ êµ¬ì„±
---

<br>

<big> **â–  chrony ì„¤ì¹˜ ë° êµ¬ì„±** </big>

```bash
$ dnf -y install chrony


$ vi /etc/chrony.conf


# line 20 : ê¸°ë³¸ ì„¤ì •ì„ ì£¼ì„ ì²˜ë¦¬í•˜ê³  ì‹œê°„ëŒ€ì— ë§ëŠ” NTP ì„œë²„ë¥¼ ì¶”ê°€
server time.bora.net iburst
#pool ntp.ubuntu.com        iburst maxsources 4
#pool 0.ubuntu.pool.ntp.org iburst maxsources 1
#pool 1.ubuntu.pool.ntp.org iburst maxsources 1
#pool 2.ubuntu.pool.ntp.org iburst maxsources 2

# í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì‹œê°„ ë™ê¸°í™” ìš”ì²­ì„ ë°›ì„ ìˆ˜ ìˆë„ë¡ í—ˆìš©í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ ë²”ìœ„ ì¶”ê°€
allow 192.168.219.0/24


$ systemctl restart chrony


# ìƒíƒœ í™•ì¸
$ chronyc sources -v

  .-- Source mode  '^' = server, '=' = peer, '#' = local clock.
 / .- Source state '*' = current best, '+' = combined, '-' = not combined,
| /             'x' = may be in error, '~' = too variable, '?' = unusable.
||                                                 .- xxxx [ yyyy ] +/- zzzz
||      Reachability register (octal) -.           |  xxxx = adjusted offset,
||      Log2(Polling interval) --.      |          |  yyyy = measured offset,
||                                \     |          |  zzzz = estimated error.
||                                 |    |           \
MS Name/IP address         Stratum Poll Reach LastRx Last sample
===============================================================================
^* time.bora.net                 3   6     7     0    -16us[+8414us] +/-   48ms
```

<br>

# ğŸ”” NTP í´ë¼ì´ì–¸íŠ¸ êµ¬ì„±
---

<br>

<big> **â–  NTP í´ë¼ì´ì–¸íŠ¸ êµ¬ì„±** </big>

+ Ubuntuì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ NTP í´ë¼ì´ì–¸íŠ¸(systemd-timesyncd)ê°€ ì‹¤í–‰ë˜ê³  ìˆìœ¼ë¯€ë¡œ ì‰½ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

+ NTPdë‚˜ Chronyì™€ ê°™ì€ ì„œë¹„ìŠ¤ë¥¼ í´ë¼ì´ì–¸íŠ¸ë¡œ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤ ì´ ê²½ìš°ì—ë„ ì‹œê°„ì„ ë™ê¸°í™”í•˜ê¸° ìœ„í•´ NTP ì„œë²„ë§Œ ì„¤ì •í•˜ë©´ ë˜ë©°, ë‹¤ë¥¸ í˜¸ìŠ¤íŠ¸ë¡œë¶€í„° ì‹œê°„ ë™ê¸°í™” ìš”ì²­ì„ ë°›ëŠ” ê¶Œí•œì€ ì„¤ì •í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.


```bash
$ vi /etc/systemd/timesyncd.conf

# ì‹œê°„ëŒ€ì— ë§ëŠ” NTP ì„œë²„ ì„¤ì •
NTP=ntp.srv.test


$ timedatectl timesync-status
       Server: 192.168.219.195 (ntp.srv.test)
Poll interval: 2min 8s (min: 32s; max 34min 8s)
         Leap: normal
      Version: 4
      Stratum: 4
    Reference: CBF8F08C
    Precision: 1us (-26)
Root distance: 40.435ms (max: 5s)
       Offset: +2.201ms
        Delay: 606us
       Jitter: 831us
 Packet count: 1
    Frequency: -61.596ppm
```
