---
title:  "[Retry, k8s] 09. ì›Œí¬ë¡œë“œ API - í¬ë¡ ì¡" 

categories:
  - KUBERNETES
tags:
  - [kubernetes]

toc: true
toc_sticky: true

date: 2023-03-01
last_modified_at: 2023-03-01
---
# [Retry, k8s] 09. ì›Œí¬ë¡œë“œ API - ì¡í¬ë¡ ì¡
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
</style>

<br>

## ğŸ”” í¬ë¡ ì¡

<br>

### ğŸ“œ í¬ë¡ ì¡ ìƒì„±

+ spec.scheduleì—ëŠ” Cronê³¼ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì‹œê°„ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

```bash
cat <<EOF > sample-cronjob.yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: sample-cronjob
spec:
  schedule: "*/1 * * * *"
  concurrencyPolicy: Allow
  startingDeadlineSeconds: 30
  successfulJobsHistoryLimit: 5
  failedJobsHistoryLimit: 3
  suspend: false
  jobTemplate:
    spec:
      completions: 1
      parallelism: 1
      backoffLimit: 0
      template:
        spec:
          containers:
          - name: tools-container
            image: amsy810/random-exit:v2.0
          restartPolicy: Never
EOF
```

```bash
$ kubectl get cronjobs
NAME             SCHEDULE      SUSPEND   ACTIVE   LAST SCHEDULE   AGE
sample-cronjob   */1 * * * *   False     0        12s             15s
```

<br>

### ğŸ“œ í¬ë¡ ì¡ ì¼ì‹œ ì •ì§€

+ spec.suspendê°€ trueë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ ìŠ¤ì¼€ì¤„ ëŒ€ìƒì—ì„œ ì œì™¸ëœë‹¤.(ê¸°ë³¸ê°’ false)

+ ì‹¤í–‰ í›„ í¬ë¡ ì¡ì„ í™•ì¸í•´ë³´ë©´ SUSPEND ë¶€ë¶„ì´ Trueë¡œ ë³€ê²½ë˜ê³  ë”ëŠ” ì¡ì´ ìƒì„±ë˜ì§€ ì•ŠëŠ”ë‹¤.

```bash
$ kubectl patch cronjob sample-cronjob -p '{"spec":{"suspend":true}}'
cronjob.batch/sample-cronjob patched

$ kubectl get cronjobs
NAME             SCHEDULE      SUSPEND   ACTIVE   LAST SCHEDULE   AGE
sample-cronjob   */1 * * * *   True      0        56s             5m59s
```

<br>

### ğŸ“œ í¬ë¡ ì¡ ì„ì˜ì˜ ì‹œì ì— ì‹¤í–‰

+ --from ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ í¬ë¡ ì¡ìœ¼ë¡œ ì¡ì„ ìƒì„±í•  ìˆ˜ë„ ìˆê³ , ì •ê¸°ì  ì‹¤í–‰ ì´ì™¸ì˜ ì‹œì ì— ì¡ì„ ìƒì„±í•˜ê³  ì‹¶ì€ ê²½ìš° ì‚¬ìš©

```bash
$ kubectl create job sample-job-from-cronjob --from cronjob/sample-cronjob
job.batch/sample-job-from-cronjob created
```

<br>

### ğŸ“œ ë™ì‹œ ì‹¤í–‰ ì œì–´(concurrencyPolicy)

+ í¬ë¡ ì¡ì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ í¬ë¡ ì¡ ì¸ìŠ¤í„´ìŠ¤ê°€ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í—ˆìš©í• ì§€ ì—¬ë¶€ë¥¼ ê²°ì •

|ì •ì±…|ê°œìš”|
|:---:|:---:|
|Allow(ê¸°ë³¸ê°’)|ë™ì‹œì— ì—¬ëŸ¬ ê°œì˜ í¬ë¡ ì¡ ì¸ìŠ¤í„´ìŠ¤ê°€ ì‹¤í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.|
|Forbid|ì´ì „ í¬ë¡ ì¡ ì¸ìŠ¤í„´ìŠ¤ê°€ ì‹¤í–‰ ì¤‘ì¸ ê²½ìš° ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹¤í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.|
|Replace|ì´ì „ í¬ë¡ ì¡ ì¸ìŠ¤í„´ìŠ¤ê°€ ì‹¤í–‰ ì¤‘ì¸ ê²½ìš° ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.|

<br>

### ğŸ“œ ì‹¤í–‰ ì‹œì‘ ê¸°í•œ ì œì–´(startingDeadlineSeconds)

+ í¬ë¡ ì¡ì´ ì‹œì‘ë˜ê¸° ì „ì— í¬ë¡ ì¡ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì¼ì‹œì ìœ¼ë¡œ ì •ì§€ë˜ëŠ” ê²½ìš° ë“±ê³¼ ê°™ì´ ì‹œì‘ ì‹œê°„ì´ ì§€ì—°ë˜ë©´, ê·¸ ì§€ì—° ì‹œê°„ì„ í—ˆìš©í•˜ëŠ” ì‹œê°„ì„ ì§€ì •

<br>

### ğŸ“œ í¬ë¡ ì¡ ì´ë ¥

+ í¬ë¡ ì¡ì´ ìƒì„±í•  ì¡ì„ ëª‡ ê°œ ìœ ì§€í• ì§€ë¥¼ ì§€ì •(ê¸°ë³¸ê°’ 3), ì´ ë‘ ì„¤ì •ê°’ì„ 0ìœ¼ë¡œ ì œí•œì„ ì„¤ì •í•œ ê²½ìš° ì¡ì€ ì¢…ë£Œ ì‹œ ì¦‰ì‹œ ì‚­ì œëœë‹¤.

#### ã€successfulJobsHistoryLimitã€‘ - ì„±ê³µí•œ ì¡ì„ ì €ì¥í•˜ëŠ” ê°œìˆ˜ 

#### ã€failedJobsHistoryLimitã€‘ - ì‹¤íŒ¨í•œ ì¡ì„ ì €ì¥í•˜ëŠ” ê°œìˆ˜

<br>