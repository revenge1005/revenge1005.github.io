---
title:  "[Rocky] 10. DNS - ê¶Œí•œ ìœ„ì„ êµ¬ì„±" 

categories:
  - ROCKY
tags:
  - [rocky, linux]

toc: true
toc_sticky: true

date: 2022-08-10
last_modified_at: 2022-08-10
---
<br>

# ğŸ”” DNS - ê¶Œí•œ ìœ„ì„
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
big {
    font-size: 15pt;
}
</style>

<br>

> ìƒìœ„ ë„ë©”ì¸ì— ì†Œì†ëœ í•˜ìœ„ ë„ë©”ì¸ì—ê²Œ í•´ë‹¹ ë„ë©”ì¸ì˜ ê´€ë¦¬, ì„œë¹„ìŠ¤ ê¶Œí•œì„ ìœ„ì„ í•¨(ìƒìœ„ ë„ë©”ì¸ â†’ í•˜ìœ„ ë„ë©”ì¸ì˜ NS ë ˆì½”ë“œ ì¶”ê°€, í•˜ìœ„ ë„ë©”ì¸ â†’ ìœ„ì„ ë°›ì€ ë„ë©”ì¸ì˜ ë ˆì½”ë“œ ìƒì„±)

+ ì˜ˆì‹œë¡œ www.b2.a2.com. ë„ë©”ì¸ì˜ ê¶Œí•œ ìœ„ì„

    + **.(root) ë„ë©”ì¸ :** com. ë„ë©”ì¸ì˜ NS ë ˆì½”ë“œ ì¶”ê°€

    + **com. ë„ë©”ì¸ :** a2.com. ë„ë©”ì¸ì˜ NS ë ˆì½”ë“œ ì¶”ê°€

    + **a2.com. ë„ë©”ì¸ :** b2.a2.com. ë„ë©”ì¸ì˜ NS ë ˆì½”ë“œ ì¶”ê°€

    + **b2.a2.com. ë„ë©”ì¸ :** www , hostì˜ A ë ˆì½”ë“œ ì¶”ê°€

<br>

<big> **â–  .(root) ë„¤ì„ ì„œë²„ êµ¬ì„±** </big>

![01](https://user-images.githubusercontent.com/42735894/232969899-54484033-3404-490d-b79b-278ef989d1e8.PNG){: width="90%" height="90%"}{: .align-center}

![111](https://user-images.githubusercontent.com/42735894/232997347-ec036a05-bf67-4b4c-80b9-0e86b702445f.PNG){: width="90%" height="90%"}{: .align-center}

<br>

<big> **â–  com. ë„¤ì„ ì„œë²„ êµ¬ì„±** </big>

![02](https://user-images.githubusercontent.com/42735894/232969983-600c3db6-aaad-4055-9597-4f1ba04cd267.PNG){: width="90%" height="90%"}{: .align-center}

![222](https://user-images.githubusercontent.com/42735894/232997360-aed0a3d5-157a-4d63-a4be-07e5c6164f36.PNG){: width="90%" height="90%"}{: .align-center}

<br>

<big> **â–  a2.com. ë„¤ì„ ì„œë²„ êµ¬ì„±** </big>

![03](https://user-images.githubusercontent.com/42735894/232969990-9317e77a-06b4-4797-9a90-4c267e1fdaa6.PNG){: width="90%" height="90%"}{: .align-center}

![333](https://user-images.githubusercontent.com/42735894/232997356-2c1dd87a-9839-4583-b3bd-cc599714ac98.PNG){: width="90%" height="90%"}{: .align-center}

<br>

<big> **â–  b2.a2.com. ë„¤ì„ ì„œë²„ êµ¬ì„±** </big>

![04](https://user-images.githubusercontent.com/42735894/232969991-afb138cd-e27a-4e7e-a860-c9e56557c5f4.PNG){: width="90%" height="90%"}{: .align-center}

![444](https://user-images.githubusercontent.com/42735894/232997353-5b5b95b3-2877-40d7-9b6a-aa2d0c5b7033.PNG){: width="90%" height="90%"}{: .align-center}

<br>

# ğŸ”” í…ŒìŠ¤íŠ¸ êµ¬ì„±
---

<br>

![222332](https://user-images.githubusercontent.com/42735894/232972015-90af1a71-92c5-4193-8635-7b3f3cffca41.png){: width="90%" height="90%"}{: .align-center}

<br>

<big> **â–  naver.com. DNS ì„œë²„ ì„¤ì •** </big>

```bash
$ vim /etc/named.conf

    # ë³€ê²½
    listen-on port 53 { any; };
    listen-on-v6 port 53 { any; };
    allow-query     { any; };

    dnssec-enable no;
    dnssec-validation no;


$ vim /etc/named.rfc1912.zones

# ì¶”ê°€
zone "naver.com" IN {
        type master;
        file "naver.com.zone";
};


$ cat /var/named/naver.com.zone
$TTL 86400
@   IN  SOA     ns.naver.com. root.naver.com. (
        2022081001  ;Serial
        3600        ;Refresh
        1800        ;Retry
        604800      ;Expire
        86400       ;Minimum TTL
)
        IN  NS      ns.naver.com.

ns      IN  A       192.168.219.10
www     IN  A       192.168.219.13
ftp     IN  A       192.168.219.18


# DNS Root hint ì„¤ì •
$ cat /var/named/named.ca

~(ìƒëµ)~

;; ANSWER SECTION:
# ì¶”ê°€
.                       518400  IN      NS      a.root-servers.net.

~(ìƒëµ)~

;; ADDITIONAL SECTION:
# ì¶”ê°€
a.root-servers.net.     518400  IN      A       192.168.219.20

~(ìƒëµ)~


$ systemctl restart named


# ë°©í™”ë²½ DNS ì„œë¹„ìŠ¤ í—ˆìš©
$ firewall-cmd --add-service=dns; firewall-cmd --runtime-to-permanent
```

<br>

<big> **â–  .(root) DNS ì„œë²„ ì„¤ì •** </big>

```bash
$ vim /etc/named.conf

    # ë³€ê²½
    listen-on port 53 { any; };
    listen-on-v6 port 53 { any; };
    allow-query     { any; };

    dnssec-enable no;
    dnssec-validation no;


$ vim /etc/named.rfc1912.zones

# ì¶”ê°€
zone "." IN {
        type master;
        file "root.zone";
};


$ vim /var/named/root.zone

$TTL 86400
@   IN  SOA     ns. root. (
        2022081001  ;Serial
        3600        ;Refresh
        1800        ;Retry
        604800      ;Expire
        86400       ;Minimum TTL
)
        IN  NS      ns.
com     IN  NS      ns.com.

ns      IN  A       192.168.219.20
ns.com  IN  A       192.168.219.30


$ systemctl restart named


# ë°©í™”ë²½ DNS ì„œë¹„ìŠ¤ í—ˆìš©
$ firewall-cmd --add-service=dns; firewall-cmd --runtime-to-permanent
```

<br>

<big> **â–  com. DNS ì„œë²„ ì„¤ì •** </big>

```bash
$ vim /etc/named.conf

    # ë³€ê²½
    listen-on port 53 { any; };
    listen-on-v6 port 53 { any; };
    allow-query     { any; };

    dnssec-enable no;
    dnssec-validation no;


$ vim /etc/named.rfc1912.zones

# ì¶”ê°€
zone "com" IN {
        type master;
        file "com.zone";
};


$ vim /var/named/root.zone

$TTL 86400
@   IN  SOA     ns.com. root.com. (
        2022081001  ;Serial
        3600        ;Refresh
        1800        ;Retry
        604800      ;Expire
        86400       ;Minimum TTL
)
        IN  NS      ns.com.
google  IN  NS      ns.google.com.

ns              IN  A       192.168.219.30
ns.google       IN  A       192.168.219.40


$ systemctl restart named


# ë°©í™”ë²½ DNS ì„œë¹„ìŠ¤ í—ˆìš©
$ firewall-cmd --add-service=dns; firewall-cmd --runtime-to-permanent
```

<br>

<big> **â–  google.com. DNS ì„œë²„ ì„¤ì •** </big>

```bash
$ vim /etc/named.conf

    # ë³€ê²½
    listen-on port 53 { any; };
    listen-on-v6 port 53 { any; };
    allow-query     { any; };

    dnssec-enable no;
    dnssec-validation no;


$ vim /etc/named.rfc1912.zones

# ì¶”ê°€
zone "google.com" IN {
        type master;
        file "google.com.zone";
};


$ vim /var/named/root.zone

$TTL 86400
@   IN  SOA     ns.google.com. root.google.com. (
        2022081001  ;Serial
        3600        ;Refresh
        1800        ;Retry
        604800      ;Expire
        86400       ;Minimum TTL
)
        IN  NS      ns.google.com.

ns      IN  A       192.168.219.40
www     IN  A       192.168.219.45
ftp     IN  A       192.168.219.48


$ systemctl restart named


# ë°©í™”ë²½ DNS ì„œë¹„ìŠ¤ í—ˆìš©
$ firewall-cmd --add-service=dns; firewall-cmd --runtime-to-permanent
```

<br>

<big> **â–  ê²°ê³¼ í™•ì¸** </big>

```bash
$ dig www.google.com @192.168.219.10

; <<>> DiG 9.16.23-RH <<>> www.google.com @192.168.219.10
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 38538
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1232
; COOKIE: 9e86e8f2c796d2e101000000643f8e7abb50772541ed9edb (good)
;; QUESTION SECTION:
;www.google.com.                        IN      A

;; ANSWER SECTION:
www.google.com.         85045   IN      A       192.168.219.45

;; Query time: 0 msec
;; SERVER: 192.168.219.10#53(192.168.219.10)
;; WHEN: Wed Apr 19 15:47:22 KST 2023
;; MSG SIZE  rcvd: 87


$ dig www.naver.com @192.168.219.10

; <<>> DiG 9.16.23-RH <<>> www.naver.com @192.168.219.10
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 17135
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1232
; COOKIE: ed4211cf7ffbf70101000000643f8ebbf83d38a17073565e (good)
;; QUESTION SECTION:
;www.naver.com.                 IN      A

;; ANSWER SECTION:
www.naver.com.          86400   IN      A       192.168.219.13

;; Query time: 0 msec
;; SERVER: 192.168.219.10#53(192.168.219.10)
;; WHEN: Wed Apr 19 15:48:28 KST 2023
;; MSG SIZE  rcvd: 86
```