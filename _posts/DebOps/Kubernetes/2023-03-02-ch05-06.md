---
title:  "[Retry, k8s] 24. ì»¨í”¼ê·¸ & ìŠ¤í† ë¦¬ì§€ API - ì˜êµ¬ ë³¼ë¥¨ í´ë ˆì„(PVC)" 

categories:
  - KUBERNETES
tags:
  - [kubernetes]

toc: true
toc_sticky: true

date: 2023-03-01
last_modified_at: 2023-03-01
---
<br>

# ğŸ”” ì˜êµ¬ ë³¼ë¥¨ í´ë ˆì„
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
</style>

**ì‹œì‘í•˜ê¸° ì „ ì„ í–‰ ì‘ì—… ë° í™•ì¸í•´ì•¼í•  ë‚´ìš©** <br> - **<https://revenge1005.github.io/kubernetes/ch03-6-1/>** <br> - **<https://revenge1005.github.io/kubernetes/ch03-6-2/>** <br> - **<https://revenge1005.github.io/kubernetes/ch03-6-3/>**
{: .notice--warning}

> **PVCëŠ” ì˜êµ¬ ë³¼ë¥¨(PV)ì„ ìš”ì²­í•˜ëŠ” ë¦¬ì†ŒìŠ¤**ë¡œ, PVCì—ì„œ ì§€ì •í•œ ì¡°ê±´(ìš©ëŸ‰, ë ˆì´ë¸”)ì„ ê¸°ë°˜ìœ¼ë¡œ PVì— ëŒ€í•œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” í˜„ì¬ ê°€ì§€ê³  ìˆëŠ” ì˜êµ¬ ë³¼ë¥¨ì—ì„œ ì ë‹¹í•œ ë³¼ë¥¨ì„ í• ë‹¹í•œë‹¤.


<br>

## (1) PVC ì„¤ì •

+ ë ˆì´ë¸” ì…€ë ‰í„°

+ ìš©ëŸ‰ 

+ ì ‘ê·¼ ëª¨ë“œ

+ ìŠ¤í† ë¦¬ì§€í´ë˜ìŠ¤

```bash
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: sample-pvc
spec:
  selector:
    matchLabels:
      type: ceph-pv
    matchExpressions:
    - key: environment
      operator: In
      values:
      - stg
  resources:
    requests:
      storage: 1Gi
  accessModes:
  - ReadWriteMany
  storageClassName: csi-fs-sc
```

<br>

## (2) PVC ìƒì„±

```bash
# PVC ì •ë³´ í™•ì¸
$ kubectl get pvc sample-pvc
NAME         STATUS   VOLUME      CAPACITY   ACCESS MODES   STORAGECLASS   AGE
sample-pvc   Bound    sample-pv   1Gi        RWX            csi-fs-sc      49s


# PV ì •ë³´ í™•ì¸
$ kubectl get pv sample-pv
NAME        CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                STORAGECLASS   REASON   AGE
sample-pv   1Gi        RWX            Retain           Bound    default/sample-pvc   csi-fs-sc               49m
```

<br>

## (2) PVC ì‚­ì œ

+ Retain ì •ì±…ì„ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²½ìš° PVCë¥¼ ì‚­ì œí•  ë•Œ PVì˜ STATUSê°€ Boundì—ì„œ Releasedë¡œ ë³€ê²½ëœë‹¤.

+ Released ìƒíƒœì˜ PVì€ ë‹¤ì‹œ PVCì—ì„œ í• ë‹¹í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

```bash
$ kubectl delete pvc sample-pvc
persistentvolumeclaim "sample-pvc" deleted


$ kubectl get pv sample-pv
NAME        CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS     CLAIM                STORAGECLASS   REASON   AGE
sample-pv   1Gi        RWX            Retain           Released   default/sample-pvc   csi-fs-sc               55m
```

<br>

## (3) ë™ì  í”„ë¡œë¹„ì €ë‹

+ ì§€ê¸ˆê¹Œì§€ PVCì—ì„œëŠ” PVì„ ë¯¸ë¦¬ ìƒì„±í•´ ë‘ê³  PVC ìš”ì²­ì— ë”°ë¼ ë³¼ë¥¨ì„ í• ë‹¹í•˜ëŠ” ìˆœì„œë¡œ ì§„í–‰ë˜ì—ˆë‹¤.

+ ê·¸ë˜ì„œ ì‚¬ì „ì— PVì„ ìƒì„±í•´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ê³¼ PVCì´ ìš”ì²­í•˜ëŠ” ìš©ëŸ‰ ì´ìƒìœ¼ë¡œ ì˜êµ¬ ë³¼ë¥¨ì´ í• ë‹¹ë˜ì–´ ë‚­ë¹„ê°€ ë°œìƒí•˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤.

+ ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê²ƒì´ ë™ì  í”„ë¡œë¹„ì €ë‹ì´ë‹¤.

+ ë™ì  í”„ë¡œë¹„ì €ë‹ì„ ì‚¬ìš©í•œ PVCì˜ ê²½ìš° PVCì´ ìƒì„±ë˜ëŠ” íƒ€ì´ë°ì— ë™ì ìœ¼ë¡œ PVë¥¼ ìƒì„±í•˜ê³  í• ë‹¹í•œë‹¤.

