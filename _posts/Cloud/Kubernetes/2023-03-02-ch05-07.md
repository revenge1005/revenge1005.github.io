---
title:  "[Retry, k8s] 25. ì»¨í”¼ê·¸ & ìŠ¤í† ë¦¬ì§€ API - volumeMountsì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì˜µì…˜" 

categories:
  - KUBERNETES
tags:
  - [kubernetes]

toc: true
toc_sticky: true

date: 2023-10-15
last_modified_at: 2023-10-15
---
<br>

# ğŸ”” volumeMountsì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì˜µì…˜
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
</style>

**ì‹œì‘í•˜ê¸° ì „ ì„ í–‰ ì‘ì—… ë° í™•ì¸í•´ì•¼í•  ë‚´ìš©** <br> - **<https://revenge1005.github.io/kubernetes/ch03-6-1/>** <br> - **<https://revenge1005.github.io/kubernetes/ch03-6-2/>** <br> - **<https://revenge1005.github.io/kubernetes/ch03-6-3/>**
{: .notice--warning}


## (1) ì½ê¸° ì •ìš©(ReadOnly) ë§ˆìš´íŠ¸

```bash
$ cat <<EOF > sample-readonly-volumemount.yaml
apiVersion: v1
kind: Pod
metadata:
  name: sample-readonly-volumemount
spec:
  containers:
  - image: nginx:1.16
    name: nginx-container
    volumeMounts:
    - mountPath: /srv
      name: hostpath-sample
      readOnly: true
  volumes:
  - name: hostpath-sample
    hostPath:
      path: /etc
      type: DirectoryOrCreate
EOF


# ë§ˆìš´íŠ¸í•œ ì˜ì—­ì˜ íŒŒì¼ì„ ë³€ê²½í•  ìˆ˜ ì—†ìŒ
$ kubectl exec -it sample-readonly-volumemount -- cat /srv/motd
cat: /srv/motd: No such file or directory
command terminated with exit code 1


# ë§ˆìš´íŠ¸í•œ ì˜ì—­ì˜ íŒŒì¼ ì½ê¸°ëŠ” ê°€ëŠ¥
$ kubectl exec -it sample-readonly-volumemount -- cat /srv/motd
Hello World
```


<br>


## (2) subPath

> subPathëŠ” ë³¼ë¥¨ì„ ë§ˆìš´íŠ¸í•  ë•Œ íŠ¹ì • ë””ë ‰í„°ë¦¬ë¥¼ ë£¨íŠ¸ë¡œ ë§ˆìš´íŠ¸í•˜ëŠ” ê¸°ëŠ¥

+ ì•„ë˜ ì˜ˆì œëŠ” ì„¸ ê°œì˜ ì»¨í…Œì´ë„ˆë¥¼ ê°€ì§„ í•˜ë‚˜ì˜ íŒŒë“œë¥¼ ìƒì„±í•˜ê³ , ê°ê°ì˜ ì»¨í…Œì´ë„ˆëŠ” ë§ˆìš´íŠ¸í•œ ë””ë ‰í„°ë¦¬ ë°”ë¡œ ì•„ë˜ì— í…ìŠ¤íŠ¸ íŒŒì¼ì„ ë°°ì¹˜í•œë‹¤.

+ subPathì—ì„œëŠ” ê° ì»¨í…Œì´ë„ˆê°€ í•˜ë‚˜ì˜ ë³¼ë¥¨ì„ ì‚¬ìš©í•˜ë©´ì„œë„ ì„œë¡œì—ê²Œ ì˜í–¥ì„ ì£¼ì§€ ì•Šë„ë¡ ë””ë ‰í„°ë¦¬ë¥¼ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.

+ ê·¸ë¦¬ê³  subPathëŠ” /path1/morepath ë“±ê³¼ ê°™ì´ 2ê³„ì¸µ ì´ìƒìœ¼ë¡œ ì§€ì •í•  ìˆ˜ ìˆë‹¤.


![2231312](https://user-images.githubusercontent.com/42735894/231099177-9c6ec049-95fa-44a3-a1ea-5aa5807432d7.png){: width="100%" height="100%"}{: .align-center}

```bash
cat <<EOF > sample-subpath.yaml
apiVersion: v1
kind: Pod
metadata:
  name: sample-subpath
spec:
  containers:
  - name: container-a
    image: alpine:3.7
    command: ["sh", "-c", "touch /data/a.txt; sleep 86400"]
    volumeMounts:
    - mountPath: /data
      name: main-volume
  - name: container-b
    image: alpine:3.7
    command: ["sh", "-c", "touch /data/b.txt; sleep 86400"]
    volumeMounts:
    - mountPath: /data
      name: main-volume
      subPath: path1
  - name: container-c
    image: alpine:3.7
    command: ["sh", "-c", "touch /data/c.txt; sleep 86400"]
    volumeMounts:
    - mountPath: /data
      name: main-volume
      subPath: path2
  volumes:
  - name: main-volume
    emptyDir: {}
EOF


# subPath /path1ì„ ì§€ì •í•œ ì»¨í…Œì´ë„ˆ
$ kubectl exec -it sample-subpath -c container-b -- find /data
/data
/data/b.txt


# subPath /path2ì„ ì§€ì •í•œ ì»¨í…Œì´ë„ˆ 
$ kubectl exec -it sample-subpath -c container-c -- find /data
/data
/data/c.txt


# subPathë¥¼ ì§€ì •í•˜ì§€ ì•Šì€ ì»¨í…Œì´ë„ˆ
$ kubectl exec -it sample-subpath -c container-a -- find /data
/data
/data/path2
/data/path2/c.txt
/data/a.txt
/data/path1
/data/path1/b.txt
```