---
title:  "[Retry, k8s] 12. ì„œë¹„ìŠ¤ API - ExternalIP" 

categories:
  - KUBERNETES
tags:
  - [kubernetes]

toc: true
toc_sticky: true

date: 2023-03-01
last_modified_at: 2023-03-01
---
# [Retry, k8s] 12. ì„œë¹„ìŠ¤ API - ExternalIP
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
</style>

<br>

## ğŸ”” ExternalIP ì„œë¹„ìŠ¤

+ **íŠ¹ì • ì¿ ë²„ë„¤í‹°ìŠ¤ ë…¸ë“œ IP ì£¼ì†Œ:í¬íŠ¸ì—ì„œ ìˆ˜ì‹ í•œ íŠ¸ë˜í”½ì„ ì»¨í…Œì´ë„ˆë¡œ ì „ì†¡í•˜ëŠ” í˜•íƒœë¡œ ì™¸ë¶€ì™€ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì„œë¹„ìŠ¤**


![41](https://user-images.githubusercontent.com/42735894/228790237-db9e110b-8416-484c-b897-3dc10f58e590.png){: width="70%" height="70%"}{: .align-center}

<br>

### ğŸ“œ ExternalIP ì„œë¹„ìŠ¤ ìƒì„±

|ì„¤ì •|ê°œìš”|
|:---:|---|
|spec.externalIPs|ì¿ ë²„ë„¤í‹°ìŠ¤ ë…¸ë“œ IP ì£¼ì†Œ(ExternalIP)|
|spec.ports[].port|ExternalIPì™€ ClientIPì—ì„œ ìˆ˜ì‹ í•  í¬íŠ¸ ë²ˆí˜¸|
|spec.ports[].targetPort|ëª©ì ì§€ ì»¨í…Œì´ë„ˆ í¬íŠ¸ ë²ˆí˜¸|


```bash
cat <<EOF > sample-externalip.yaml
apiVersion: v1
kind: Service
metadata:
  name: sample-externalip
spec:
  type: ClusterIP
  externalIPs:
  - 192.168.219.101
  - 192.168.219.102
  ports:
  - name: "http-port"
    protocol: "TCP"
    port: 8080
    targetPort: 80
  selector:
    app: sample-app
EOF
```

```bash 
# ì¿ ë²„ë„¤í‹°ìŠ¤ ë…¸ë“œ ëª©ë¡ê³¼ ì£¼ì†Œ ì¶œë ¥
$ kubectl get nodes -o custom-columns="NAME:{metadata.name},IP:{status.addresses[].address}"
NAME         IP
k8s-master   192.168.219.100
k8s-node01   192.168.219.101
k8s-node02   192.168.219.102


# ExternalIP ì„œë¹„ìŠ¤ í™•ì¸
$  kubectl get service
NAME                TYPE        CLUSTER-IP      EXTERNAL-IP                       PORT(S)    AGE
kubernetes          ClusterIP   10.96.0.1       <none>                            443/TCP    32m
sample-externalip   ClusterIP   10.103.153.68   192.168.219.101,192.168.219.102   8080/TCP   4m24s


# ì¼ì‹œì ìœ¼ë¡œ íŒŒë“œë¥¼ ê¸°ë™í•˜ì—¬ A ë ˆì½”ë“œë¡œ ClusterIPê°€ ë‹¤ë¥¸ íŒŒë“œì—ì„œ í•´ì„ ê°€ëŠ¥í•¨ì„ í™•ì¸
$ kubectl run --image=amsy810/tools:v2.0 --restart=Never --rm -i testpod --command -- dig sample-externalip.default.svc.cluster.local

(ìƒëµ)

;; QUESTION SECTION:
;sample-externalip.default.svc.cluster.local. IN        A

;; ANSWER SECTION:
sample-externalip.default.svc.cluster.local. 30 IN A 10.103.153.68
```

<br>