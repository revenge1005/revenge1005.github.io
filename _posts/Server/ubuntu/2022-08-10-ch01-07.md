---
title:  "[Ubuntu] 07. Samba ì„œë²„ êµ¬ì„±" 

categories:
  - UBUNTU
tags:
  - [ubuntu, linux]

toc: true
toc_sticky: true

date: 2021-05-02
last_modified_at: 2021-05-02
---
<br>

# ğŸ”” ê³µìœ  í´ë” (ìµëª… í¬í•¨)
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
big {
    font-size: 15pt;
}
</style>

<br>

<big> **â–  samba ì„¤ì¹˜** </big>

```bash
$ apt -y install samba
```

<br>

<big> **â–  samba êµ¬ì„±** </big>

```bash
$ mkdir /home/share

$ chmod 777 /home/share

$ vi /etc/samba/smb.conf

[global]
   # line 25 : add (set charset)
   unix charset = UTF-8

   # line 40 : uncomment and add network you allow to access
   interfaces = 192.168.219.0/24

   # line 101 : confirm (no authentication)
   map to guest = bad user

...


[Share]
   # ê³µìœ  ë””ë ‰í„°ë¦¬ ì§€ì •
   path = /home/share
   # ì“°ê¸° í—ˆìš©
   writable = yes
   # ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ì í—ˆìš©
   guest ok = yes
   # ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ìë¡œ ëª¨ë‘ í‘œì‹œ
   guest only = yes
   # íŒŒì¼ì„ ë§Œë“¤ ë•Œ ì‚¬ìš© ê¶Œí•œ [ì‚¬ìš© ê¶Œí•œ] ì„¤ì •
   force create mode = 777
   # í´ë”ë¥¼ ë§Œë“¤ ë•Œ [ì‚¬ìš© ê¶Œí•œ] ì„¤ì •
   force directory mode = 777 

$ systemctl restart smbd
```

<br>

<big> **â–  í™•ì¸** </big>

![1312312](https://github.com/revenge1005/Kubernetes-Study/assets/42735894/1f109c7c-81b8-4619-a4a7-abc66982dece){: width="100%" height="100%"}{: .align-center}

![asdasd](https://github.com/revenge1005/Kubernetes-Study/assets/42735894/c5aa0b73-bbd7-4eaa-ba95-960835c8ce18){: width="100%" height="100%"}{: .align-center}

<br>

# ğŸ”” ì œí•œëœ ê³µìœ  í´ë”
---

```bash
$ groupadd smbgroup01

$ mkdir /home/share01

$ chgrp smbgroup01 /home/share01

$ chmod 770 /home/share01


$ vi /etc/samba/smb.conf

[global]
   # line 25 : add (set charset)
   unix charset = UTF-8

   # line 40 : uncomment and add network you allow to access
   interfaces = 127.0.0.0/8 10.0.0.0/24

   # line 101 : comment out and add the line below
   #map to guest = bad user
   security = user

...

[Share01]
    # ê³µìœ  ë””ë ‰í„°ë¦¬ ì§€ì •
    path = /home/share01
    # ì“°ê¸° í—ˆìš©
    writable = yes
    # ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ì í—ˆìš© ì•ˆ í•¨
    guest ok = no
    # [smbgroup01] ê·¸ë£¹ë§Œ í—ˆìš©
    valid users = @smbgroup01
    # ìƒˆ íŒŒì¼/ë””ë ‰í† ë¦¬ì— ëŒ€í•œ ê·¸ë£¹ì„ [smbgroup01]ë¡œ ì„¤ì •
    force group = smbgroup01
    # íŒŒì¼ ìƒì„±ì‹œ ê¶Œí•œ ì„¤ì • [770]
    force create mode = 770
    # í´ë” ìƒì„±ì‹œ ê¶Œí•œ ì„¤ì • [770]
    force directory mode = 770
    # ìƒìœ„ í´ë”ì—ì„œ ê¶Œí•œ ìƒì†
    inherit permissions = yes 


$ systemctl restart smbd


# add Samba user
$ smbpasswd -a test5
New SMB password:           # password ì„¤ì •
Retype new SMB password:
Added user test5.


$ usermod -aG smbgroup01 test5
```

<br>

<big> **â–  í™•ì¸** </big>

![15487](https://github.com/revenge1005/Kubernetes-Study/assets/42735894/70ea78b8-ab8a-427b-99e9-8fbc54b98fc0){: width="100%" height="100%"}{: .align-center}

![123e1qweqwe](https://github.com/revenge1005/Kubernetes-Study/assets/42735894/90d699df-7959-41f2-a1c5-3e2bf7d4c44e){: width="100%" height="100%"}{: .align-center}

![48787](https://github.com/revenge1005/Kubernetes-Study/assets/42735894/b01c71e8-5e9d-48f4-a07c-3b2e0ebce85b){: width="100%" height="100%"}{: .align-center}

<br><br>

# ğŸ”” Ubuntu í´ë¼ì´ì–¸íŠ¸
---

```bash
$ apt -y install smbclient cifs-utils


# [smbclient] ëª…ë ¹ ì•¡ì„¸ìŠ¤ ì‚¬ìš©
# smbclient (share name) -U (user name)
$ smbclient '\\192.168.219.195\Share01' -U test5
Password for [WORKGROUP\test5]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Mon Jun  5 10:59:28 2023
  ..                                  D        0  Mon Jun  5 10:48:37 2023
  test.txt                            N 10485760  Mon Jun  5 10:59:28 2023

                10218772 blocks of size 1024. 4641360 blocks available


# íŒŒì¼ ë‹¤ìš´ë¡œë“œ
smb: \> mget test.txt
Get file test.txt? y
getting file \test.txt of size 10485760 as test.txt (144225.2 KiloBytes/sec) (average 144225.4 KiloBytes/sec)
smb: \> !ls
arith.awk  a.sed  c.sed  disk_total.awk  i.sed  snap  test.txt
smb: \> exit


# ë§ˆìš´íŠ¸
# [vers=(SMB protocol version)]
$ mount -t cifs -o vers=3.0,username=test5 '\\192.168.219.195\Share01' /mnt
Password for test5@\\192.168.219.195\Share01:

# ì¸ì¦ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê²½ìš°
$ mount -t cifs -o vers=3,username=none,password=none '\\192.168.219.195\Share' /mnt

$ df -hT
Filesystem                        Type   Size  Used Avail Use% Mounted on
tmpfs                             tmpfs  195M  1.2M  194M   1% /run
/dev/mapper/ubuntu--vg-ubuntu--lv ext4   9.8G  4.9G  4.4G  53% /
tmpfs                             tmpfs  971M     0  971M   0% /dev/shm
tmpfs                             tmpfs  5.0M     0  5.0M   0% /run/lock
/dev/sda2                         ext4   1.8G  130M  1.5G   8% /boot
tmpfs                             tmpfs  195M  4.0K  195M   1% /run/user/0
//192.168.219.195/Share01         cifs   9.8G  5.4G  4.5G  55% /mnt
//192.168.219.195/Share           cifs   9.8G  5.4G  4.5G  55% /mnt
```