---
title:  "[KUBERNETES] 15. μ›ν¬λ΅λ“ API - μ¤ν…μ΄νΈν’€μ…‹" 

categories:
  - KUBERNETES
tags:
  - [kubernetes]

toc: true
toc_sticky: true

date: 2023-03-01
last_modified_at: 2023-03-01
---
# [KUBERNETES] 15. μ›ν¬λ΅λ“ API - μ¤ν…μ΄νΈν’€μ…‹
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
</style>

<br>

## π”” μ‹μ‘ν•κΈ° μ „ ...

> λ ν”λ¦¬μΉ΄μ…‹μ€ νλ“ λ³µμ λ³Έμ„ μƒμ„±ν•  λ• μ΄λ¦„ λ° μ£Όμ†λ§ λ‹¤λ¥Ό λΏ λ‚λ¨Έμ§€λ” λ¨λ‘ λ‘κ°™μ€ νλ“λ¥Ό μƒμ„±λλ‹¤. <br><br>
λ§μ•½ <u>νλ“κ°€ PVCλ¥Ό μ°Έμ΅°ν•λ‹¤λ©΄ μ΄ μ—­μ‹ λ‘κ°™μ€ PVCλ¥Ό μ—°κ²°ν•κ² λκ³  ν•΄λ‹Ή PVCλ” νΉμ • ν•λ‚μ PVμ— μ—°κ²°ν•λ‹¤.</u> **(μ¦‰, ν•­μƒ λ‘κ°™μ€ λ³Όλ¥¨μ— μ—°κ²°ν•λ‹¤λ” μλ―Έ)**

![1](https://user-images.githubusercontent.com/42735894/225531010-9f3d1495-5286-4e3c-9898-b767f4d05e56.png){: width="100%" height="100%"}{: .align-center} <br>

- λ ν”λ¦¬μΉ΄μ…‹μ΄ μ κ³µν•λ” νλ“λ” <u>κ° λ³„λ„μ λ³Όλ¥¨μ„ μ‚¬μ©ν•  μ μλ” λ°©λ²•μ„ μ κ³µν•΄μ£Όμ§€ μ•μ•„ λ¨λ‘ κ°™μ€ λ³Όλ¥¨μΌλ΅ κ°™μ€ μƒνƒλ¥Ό κ°€μ§μ λ°–μ— μ—†μ—λ‹¤</u>.

- λν• λ°μ΄ν„°λ² μ΄μ¤μ²λΌ μƒνƒλ¥Ό κ°–λ”(Stateful) μ• ν”λ¦¬μΌ€μ΄μ…μ„ μΏ λ²„λ„¤ν‹°μ¤μ—μ„ μ‹¤ν–‰ν•λ” κ²ƒμ€ λ§¤μ° λ³µμ΅ν• μΌμ΄λ‹¤.

    - νλ“ λ‚΄λ¶€μ λ°μ΄ν„°λ¥Ό μ–΄λ–»κ² κ΄€λ¦¬ν•΄μ•Ό ν• μ§€, μƒνƒλ¥Ό κ°–λ” νλ“μ—λ” μ–΄λ–»κ² μ ‘κ·Όν•  μ μμ„μ§€ λ“±μ„ κΌΌκΌΌν κ³ λ ¤ν•΄μ•Ό ν•κΈ° λ•λ¬Έμ΄λ‹¤.

    - μΏ λ³΄λ„¤ν‹°μ¤λ” μ΄μ— λ€ν• <u>ν•΄κ²°μ±…μ„ μ¤ν…μ΄νΈν’€μ…‹μ΄λΌλ” μ¤λΈμ νΈλ¥Ό μ κ³µ</u>ν•κ³  μλ‹¤.

<br>

## π”” μ¤ν…μ΄νΈν’€μ…‹

> μ¤ν…μ΄νΈν’€μ…‹μ€ μƒνƒλ¥Ό κ°€μ§€κ³  μλ”(statefull) μ• ν”λ¦¬μΌ€μ΄μ…μ„ κ΄€λ¦¬ν•λ”λ° μ‚¬μ©ν•κΈ° μ„ν• λ¦¬μ†μ¤

- Stateful μ• ν”λ¦¬μΌ€μ΄μ… : μ• ν”λ¦¬μΌ€μ΄μ…μ μ‹¤ν–‰ μƒνƒλ‚ μ‚¬μ©μμ μ…λ ¥ λ“±μ„ μ €μ¥ν•κ³  μ μ§€ν•λ” μ• ν”λ¦¬μΌ€μ΄μ…

- Stateless μ• ν”λ¦¬μΌ€μ΄μ… : μ‚¬μ©μμ μ”μ²­μ— λ”°λΌ κ²°κ³Όλ¥Ό λ°ν™ν•κ±°λ‚ μ²λ¦¬ν•λ”λ°λ§ μ§‘μ¤‘ν•λ” μ• ν”λ¦¬μΌ€μ΄μ…

<br>

### π“ μ¤ν…μ΄νΈν’€μ…‹ νΉμ§•

#### γ€μ¤ν…μ΄νΈν’€μ…‹μ€ νλ“λ“¤μ μμ„μ™€ κ³ μ μ„±μ„ λ³΄μ¥ν•¨γ€‘

- κ° νλ“λ” κ³ μ ν• μ΄λ¦„κ³Ό λ„¤νΈμ›ν¬ μ‹λ³„μλ¥Ό κ°€μ§€λ©°, μ¤ν…μ΄νΈν’€μ…‹μ— μ†ν• νλ“λ“¤μ€ μμ°¨μ μΌλ΅ μƒμ„± λ° μ‚­μ λλ‹¤.

#### γ€μ¤ν…μ΄νΈν’€μ…‹μ€ μ•μ •μ μΈ μ§€μ†μ„±μ„ κ°–λ” κ°κ° κ³ μ ν• μ¤ν† λ¦¬μ§€λ¥Ό μ κ³µν•¨γ€‘

- κ° νλ“λ” μμ‹ μ—κ² ν• λ‹Ήλ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ„ μ‚¬μ©ν•λ©°, νλ“κ°€ μ¬μƒμ„±λμ–΄λ„ λ°μ΄ν„°λ¥Ό μ μ§€ν•  μ μλ‹¤.

#### γ€μ¤ν…μ΄νΈν’€μ…‹μ€ λ΅¤λ§ μ—…λ°μ΄νΈ μ „λµμ„ ν†µν•΄ νλ“λ“¤μ„ μμ°¨μ μΌλ΅ μ‚­μ ν•κ³  μ¬μƒμ„±μ΄ κ°€λ¥ν•¨γ€‘

- μ΄λ• κ°€μ¥ ν° μμ„ μƒ‰μΈμ—μ„λ¶€ν„° μ‘μ€ μμ„ μƒ‰μΈμ½μΌλ΅ μ—…λ°μ΄νΈκ°€ μ§„ν–‰λλ©°, ν• λ²μ— ν•λ‚μ”© μ—…λ°μ΄νΈλλ‹¤.

<br>

### π“ μ¤ν…μ΄νΈν’€μ…‹ μ£Όμμ‚¬ν•­

#### γ€νλ“μ— μ‚¬μ©ν•  μ¤ν† λ¦¬μ§€λ” PVCλ¥Ό ν†µν•΄μ„λ§ κ°€λ¥ν•λ‹¤.γ€‘

- λ―Έλ¦¬ PVλ¥Ό μƒμ„±ν•΄λ†“κ±°λ‚ StorageClassλ¥Ό μ‚¬μ©ν•΄ λ™μ  ν”„λ΅λΉ„μ €λ‹μ„ μ‚¬μ©

#### γ€μ¤ν…μ΄νΈν’€μ…‹μ„ μ‚­μ ν•κ±°λ‚ νλ“λ¥Ό μ‚­μ ν•λ”λΌλ„ λ³Όλ¥¨μ€ μ‚­μ λμ§€ μ•λ”λ‹¤.γ€‘**

- **λ°μ΄ν„°μ μ•μ „μ„ λ³΄μ¥**ν•κΈ° μ„ν•΄μ„ μ¤ν…μ΄νΈν’€μ…‹ κ΄€λ¦¬ν•μ νλ“κ°€ λ¶„μ‹¤ν•λ” κ²½μ°, λ™μΌν• μ΄λ¦„μΌλ΅ μƒλ΅­κ² νλ“κ°€ κΈ°λ™λλ©° μ΄λ• κΈ°μ΅΄ νλ“κ°€ μ‚¬μ©ν–λ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ„ μ΄μ–΄μ„ μ‚¬μ©ν•λ‹¤.

- **νΉμ • λ…Έλ“κ°€ μ—°κ²°μ΄ λμ–΄μ΅μ„ λ• μ¤ν…μ΄νΈν’€μ…‹μ€ μƒλ΅μ΄ νλ“λ¥Ό κΈ°λ™ν•μ§€ μ•λ”λ‹¤.** λ§μ•½ λ§μ¤ν„°μ™€μ ν†µμ‹ μ΄ μΌμ‹μ μΌλ΅ λκ²Όμ§€λ§ νλ“λ” κ³„μ†ν•΄μ„ λμ•„κ°€κ³  μλ” κ²½μ°, λ§μ¤ν„°κ°€ λ€μ²΄ νλ“λ¥Ό κΈ°λ™ν•μ—¬ νΌμ‹μ¤ν„΄νΈ λ³Όλ¥¨μ„ λ§μ΄νΈν•κ² λλ©΄ μ¤νλ ¤ λ°μ΄ν„°κ°€ νμ†λ  μ μκΈ° λ•λ¬Έμ΄λ‹¤.

- λ‹¤μ μ¤‘ ν• κ°€μ§€ κ²½μ°μ—λ§ μ¤ν…μ΄νΈν’€μ…‹μ΄ λ¶„μ‹¤λ νλ“λ¥Ό λ‹¤λ¥Έ λ…Έλ“μ—μ„ λ‹¤μ‹ κΈ°λ™ν•λ‹¤.

    - μ¥μ•  λ…Έλ“λ¥Ό K8s ν΄λ¬μ¤ν„°μ λ§΄λ²„μ—μ„ μ μ™Έν•¨

    - λ¬Έμ κ°€ μλ” νλ“λ¥Ό κ°•μ  μΆ…λ£ν•¨

    - μ¥μ• λ΅ μΈν•΄ μ •μ§€ν• λ…Έλ“λ¥Ό μ¬κΈ°λ™ν•¨

#### γ€ν—¤λ“λ¦¬μ¤ μ„λΉ„μ¤ ν•„μ”γ€‘

- Serviceλ” κΈ°λ³Έμ μΌλ΅ λ μ΄λΈ” μ…€λ ‰ν„°κ°€ μΌμΉν•λ” λλ¤ν• νλ“λ¥Ό μ„ νƒν•΄ νΈλν”½μ„ μ „λ‹¬ν•κΈ° λ•λ¬Έμ— μ”μ²­μ„ λ¶„μ‚°μ‹ν‚¤μ§€λ§, μ¤ν…μ΄νΈν’€μ…‹μ κ° νλ“λ” κ³ μ ν•κ² μ‹λ³„λμ–΄μ•Όν•λ©°, ν¬λ“μ— μ ‘κ·Όν•  λ•μ—λ„ κ°λ³„ νλ“μ— μ ‘κ·Όν•΄μ•Ό ν•λ‹¤.

- ν—¤λ“λ¦¬μ¤ μ„λΉ„μ¤λ” **ClusterIPκ°€ μ—†λ” μ„λΉ„μ¤λ¥Ό μλ―Έν•λ©°, κ° νλ“μ— κ³ μ ν• DNS μ΄λ¦„μ„ λ¶€μ—¬**ν•  μ μμ–΄ νλ“μ— μ§μ ‘ μ ‘κ·Όν•  μ μλ‹¤.

- ν—¤λ“λ¦¬μ¤ μ„λΉ„μ¤λ” λ΅λ“λ°Έλ°μ‹±μ΄λ‚ λ‹¨μΌ μ„λΉ„μ¤ IPκ°€ ν•„μ”ν•μ§€ μ•μ„ κ²½μ°μ— μ‚¬μ©λλ‹¤.

<br>

### π“ μ¤ν…μ΄νΈν’€μ…‹μ νλ“ μ΄λ¦„

```bash
# νλ“ μ΄λ¦„ ν•μ‹
{StatefulSet-Name}-{Order}

# μμ‹
mysql-0
mysql-1
```

<br>

### π“ μ¤ν…μ΄νΈν’€μ…‹μ νλ“ DNS μ£Όμ†

```bash
# ν—¤λ“λ¦¬μ¤ μ„λΉ„μ¤μ™€ μ¤ν…μ΄νΈν’€μ…‹μ„ κ°™μ΄ μ‚¬μ©ν• κ²½μ°, νλ“μ DNS μ£Όμ† ν•μ‹
# Governing-Service-Domainμ€ statefulset.spec.serviceNameμ— μ„ μ–Έν•λ©° ν•΄λ‹Ή ν•„λ“μ— ν—¤λ“λ¦¬μ¤ μ„λΉ„μ¤μ μ΄λ¦„μ„ μ§€μ •ν•¨
{Pod-Name}.{Governing-Service-Domain}.{Namespace}.svc.cluster.local

# μμ‹
mysql-0.mysql.default.svc.cluster.local
mysql-1.mysql.default.svc.cluster.local
```