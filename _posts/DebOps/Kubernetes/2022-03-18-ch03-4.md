---
title:  "[KUBERNETES] 13. ì›Œí¬ë¡œë“œ API - ë””í”Œë¡œì´ë¨¼íŠ¸" 

categories:
  - KUBERNETES
tags:
  - [kubernetes]

toc: true
toc_sticky: true

date: 2022-03-18
last_modified_at: 2022-03-18
---
# [KUBERNETES] 13. ì›Œí¬ë¡œë“œ API - ë””í”Œë¡œì´ë¨¼íŠ¸
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
</style>

<br>

## ğŸ”” ë””í”Œë¡œì´ë¨¼íŠ¸

> **ì—¬ëŸ¬ ë ˆí”Œë¦¬ì¹´ì…‹ì„ ê´€ë¦¬í•˜ì—¬ ë¡¤ë§ ì—…ë°ì´íŠ¸ë‚˜ ë¡¤ë°± ë“±ì„ êµ¬í˜„í•˜ëŠ” ë¦¬ì†ŒìŠ¤**, ë””í”Œë¡œì´ë¨¼íŠ¸ê°€ ë ˆí”Œë¦¬ì¹´ì…‹ì„ ê´€ë¦¬í•˜ê³  ë ˆí”Œë¦¬ì¹´ì…‹ì´ íŒŒë“œë¥¼ ê´€ë¦¬í•˜ëŠ” ê´€ê³„ì´ë‹¤.

<br>

### ğŸ“œ ë””í”Œë¡œì´ë¨¼íŠ¸ ìƒì„±

```bash
cat <<EOF > sample-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sample-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: sample-app
  template:
    metadata:
      labels:
        app: sample-app
    spec:
      containers:
        - name: nginx-container
          image: nginx:1.16
EOF
```

<br>

## ğŸ”” ë””í”Œë¡œì´ë¨¼íŠ¸ ì—…ë°ì´íŠ¸(ë ˆí”Œë¦¬ì¹´ì…‹ì´ ìƒì„±ë˜ëŠ”) ì¡°ê±´

> ë””í”Œë¡œì´ë¨¼íŠ¸ì—ì„œ **íŒŒë“œ í…œí”Œë¦¿(spec.templat)ì„ ë³€ê²½í•˜ë©´ ìƒˆë¡œìš´ ë ˆí”Œë¦¬ì¹´ì…‹ì´ ìƒì„±ë˜ê³  ë¡¤ë§ ì—…ë°ì´íŠ¸ê°€ ì§„í–‰ë˜ëŠ”ë° ì´ ë•Œ, ë ˆí”Œë¦¬ì¹´ì…‹ì€ íŒŒë“œ í…œí”Œë¦¿ì˜ í•´ì‹œê°’(pod-templat-hash)ì„ ë ˆì´ë¸”(ì˜¤ë¸Œì íŠ¸ë¥¼ ì‹ë³„í•˜ê³  êµ¬ë³„í•˜ëŠ” ë©”íƒ€ë°ì´í„°)ë¡œ ì‚¬ìš©í•˜ì—¬ íŒŒë“œë¥¼ ì‹ë³„í•˜ê³  ê´€ë¦¬**í•œë‹¤. ë§Œì•½ íŒŒë“œ í…œí”Œë¦¿ì„ ì´ì „ ë²„ì „ìœ¼ë¡œ ë˜ëŒë¦¬ë©´ í•´ì‹œê°’ë„ ê°™ì•„ì§€ë¯€ë¡œ ìƒˆë¡œìš´ ë ˆí”Œë¦¬ì¹´ì…‹ì„ ìƒì„±í•˜ì§€ ì•Šê³  ê¸°ì¡´ì˜ ê²ƒì„ ì‚¬ìš©í•œë‹¤.

```bash
# ë””í”Œë¡œì´ë¨¼íŠ¸ í™•ì¸ - í•´ì‹œ ê°’ì€ "845c7cc945"
$ kubectl get all -o wide
NAME                                     READY   STATUS    RESTARTS   AGE   IP          NODE         NOMINATED NODE   READINESS GATES
pod/sample-deployment-845c7cc945-jnt6s   1/1     Running   0          3s    10.44.0.1   k8s-node01   <none>           <none>
pod/sample-deployment-845c7cc945-qq67w   1/1     Running   0          3s    10.36.0.2   k8s-node02   <none>           <none>
pod/sample-deployment-845c7cc945-wq7c9   1/1     Running   0          3s    10.36.0.1   k8s-node02   <none>           <none>

NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE   SELECTOR
service/kubernetes   ClusterIP   10.96.0.1    <none>        443/TCP   45h   <none>

NAME                                READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS        IMAGES       SELECTOR
deployment.apps/sample-deployment   3/3     3            3           3s    nginx-container   nginx:1.16   app=sample-app

NAME                                           DESIRED   CURRENT   READY   AGE   CONTAINERS        IMAGES       SELECTOR
replicaset.apps/sample-deployment-845c7cc945   3         3         3       3s    nginx-container   nginx:1.16   app=sample-app,pod-template-hash=845c7cc945


# ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
$ kubectl set image deployment sample-deployment nginx-container=nginx:1.17 --record


# ë‹¤ì‹œ ë””í”Œë¡œì´ë¨¼íŠ¸ í™•ì¸ - í•´ì‹œ ê°’ì´ "6c8bfc45d6" ë³€ê²½ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
$ kubectl get all -o wide
NAME                                     READY   STATUS    RESTARTS   AGE   IP          NODE         NOMINATED NODE   READINESS GATES
pod/sample-deployment-6c8bfc45d6-fwnpv   1/1     Running   0          47s   10.44.0.2   k8s-node01   <none>           <none>
pod/sample-deployment-6c8bfc45d6-ngpbb   1/1     Running   0          43s   10.44.0.1   k8s-node01   <none>           <none>
pod/sample-deployment-6c8bfc45d6-p6vhn   1/1     Running   0          46s   10.36.0.3   k8s-node02   <none>           <none>

NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE   SELECTOR
service/kubernetes   ClusterIP   10.96.0.1    <none>        443/TCP   45h   <none>

NAME                                READY   UP-TO-DATE   AVAILABLE   AGE    CONTAINERS        IMAGES       SELECTOR
deployment.apps/sample-deployment   3/3     3            3           118s   nginx-container   nginx:1.17   app=sample-app

NAME                                           DESIRED   CURRENT   READY   AGE    CONTAINERS        IMAGES       SELECTOR
replicaset.apps/sample-deployment-6c8bfc45d6   3         3         3       47s    nginx-container   nginx:1.17   app=sample-app,pod-template-hash=6c8bfc45d6
replicaset.apps/sample-deployment-845c7cc945   0         0         0       118s   nginx-container   nginx:1.16   app=sample-app,pod-template-hash=845c7cc945
```

<br>

## ğŸ”” ë³€ê²½ ë¡¤ë°±

> ë””í”Œë¡œì´ë¨¼íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” ë¡¤ë°± ê¸°ëŠ¥ì˜ ì‹¤ì²´ëŠ” **í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ ë ˆí”Œë¦¬ì¹´ì…‹ì˜ ì „í™˜**ê³¼ ê°™ì€ ê²ƒì€ë°, ë””í”Œë¡œì´ë¨¼íŠ¸ê°€ ìƒì„±í•œ **ê¸°ì¡´ ë ˆí”Œë¦¬ì¹´ì…‹ì€ ë ˆí”Œë¦¬ì¹´ ìˆ˜ê°€ 0ì¸ ìƒíƒœë¡œ ë‚¨ì•„ ìˆê¸° ë•Œë¬¸ì— ë ˆí”Œë¦¬ì¹´ ìˆ˜ë¥¼ ë³€ê²½ì‹œì¼œ ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìƒíƒœê°€ ëœë‹¤.**

```bash
# ë³€ê²½ ì´ë ¥ í™•ì¸
$ kubectl rollout history deployment sample-deployment


# ì´ˆê¸° ìƒíƒœì˜ ë””í”Œë¡œì´ë¨¼íŠ¸
$ kubectl rollout history deployment sample-deployment --revision 1
deployment.apps/sample-deployment with revision #1
Pod Template:
  Labels:       app=sample-app
        pod-template-hash=845c7cc945
  Containers:
   nginx-container:
    Image:      nginx:1.16
    Port:       <none>
    Host Port:  <none>
    Environment:        <none>
    Mounts:     <none>
  Volumes:      <none>


# í•œ ë²ˆ ì—…ë°ì´íŠ¸ëœ í›„ì˜ ë””í”Œë¡œì´ë¨¼íŠ¸
$ kubectl rollout history deployment sample-deployment --revision 2
deployment.apps/sample-deployment with revision #2
Pod Template:
  Labels:       app=sample-app
        pod-template-hash=6c8bfc45d6
  Containers:
   nginx-container:
    Image:      nginx:1.17
    Port:       <none>
    Host Port:  <none>
    Environment:        <none>
    Mounts:     <none>
  Volumes:      <none>


# ë²„ì „ ë²ˆí˜¸ë¥¼ ì§€ì •í•˜ì—¬ ë¡¤ë°±í•˜ëŠ” ê²½ìš°
$ kubectl rollout undo deployment sample-deployment --to-revision 1


# ë°”ë¡œ ì´ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ë°±í•˜ëŠ” ê²½ìš° (ê¸°ë³¸ê°’ì¸ --to-revision 0ì´ ì§€ì •ë˜ì–´ ë°”ë¡œ ì´ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ë°±)
$ kubectl rollout undo deployment sample-deployment


# ë¡¤ë°±í•œ í›„ ì´ì „ ë ˆí”Œë¦¬ì¹´ì…‹ì—ì„œ íŒŒë“œê°€ ê¸°ë™ë¨
$ kubectl get replicasets
NAME                           DESIRED   CURRENT   READY   AGE
sample-deployment-6c8bfc45d6   0         0         0       8m5s    # ì‹ ê·œ ë ˆí”Œë¦¬ì¹´ì…‹
sample-deployment-845c7cc945   3         3         3       8m10s   # ì´ì „ ë ˆí”Œë¦¬ì¹´ì…‹
```

<br>

## ğŸ”” ë””í”Œë¡œì´ë¨¼íŠ¸ ë³€ê²½ ì¼ì‹œ ì¤‘ì§€

> ë””í”Œë¡œì´ë¨¼íŠ¸ë¥¼ ì—…ë°ì´íŠ¸í•˜ë©´ ë°”ë¡œ ì ìš© ë˜ì§€ë§Œ, ë§Œì•½ ì•ˆì „ì„ ìœ„í•´ ë””í”Œë¡œì´ë¨¼íŠ¸ì— ëŒ€í•œ ì—…ë°ì´íŠ¸ë¥¼ í•˜ë”ë¼ë„ ë°”ë¡œ ì ìš©ë˜ì§€ ì•ŠëŠ” ê²ƒì„ ì›í•˜ëŠ” ê²½ìš°ë¥¼ ìœ„í•´ ì¦‰ì‹œ ì ìš©ë˜ì§€ ì•ŠëŠ” êµ¬ì¡°ë„ ì¤€ë¹„ë˜ì–´ ìˆë‹¤. (ë¨¼ì € kubectl rollout pauseë¥¼ ì‹¤í–‰í•˜ê³  ë‹¤ì‹œ ì‹œì‘í•  ë•ŒëŠ” kubectl rollout resumeì„ ì‹¤í–‰í•œë‹¤.)

```bash
# ì—…ë°ì´íŠ¸ ì¼ì‹œ ì •ì§€
$ kubectl rollout pause deployment sample-deployment

# ì—…ë°ì´íŠ¸ ì¼ì‹œ ì •ì§€ í•´ì œ
$ kubectl rollout resume deployment sample-deployment
```

```bash
# ì—…ë°ì´íŠ¸ ì¼ì‹œ ì •ì§€
$ kubectl rollout pause deployment sample-deployment

# pause ìƒíƒœì—ì„œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì—…ë°ì´íŠ¸
$ kubectl set image deployment sample-deployment nginx-container=nginx:1.17

# ì—…ë°ì´íŠ¸ ëŒ€ê¸° ìƒíƒœ í™•ì¸
$ kubectl rollout status deployment sample-deployment
Waiting for deployment "sample-deployment" rollout to finish: 0 out of 3 new replicas have been updated...

# ì—…ë°ì´íŠ¸ ì¼ì‹œ ì •ì§€ í•´ì œí•˜ë©´ ì—…ë°ì´íŠ¸ê°€ ì§„í–‰ëœë‹¤.
$ kubectl rollout resume deployment sample-deployment
```

<br>

## ğŸ”” ë””í”Œë¡œì´ë¨¼íŠ¸ ì—…ë°ì´íŠ¸ ì „ëµ

> ë””í”Œë¡œì´ë¨¼íŠ¸ë¥¼ ì—…ë°ì´íŠ¸ í•˜ë©´ ë¡¤ë§ ì—…ë°ì´íŠ¸ê°€ ì‹¤í–‰ë˜ëŠ”ë°, ì´ê²ƒì€ ì—…ë°ì´íŠ¸ ì „ëµì„ ì§€ì •í•˜ëŠ” "spec.strategy.type"ì´ë¼ëŠ” í•­ëª©ì˜ ê¸°ë³¸ê°’ì´ RollingUpdateìœ¼ë¡œ ë˜ì–´ ìˆì–´ì„œ ì´ë©°, ì—…ë°ì´íŠ¸ ì „ëµì€ Recreateì™€ RollingUpdateê°€ ìˆë‹¤.

### (a) Recreate

> ëª¨ë“  íŒŒë“œë¥¼ í•œ ë²ˆ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ìƒì„±í•˜ê¸° ë•Œë¬¸ì— ë‹¤ìš´íƒ€ì„ì´ ë°œìƒí•˜ì§€ë§Œ, ì¶”ê°€ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì „í™˜ì´ ë¹ ë¥¸ ê²ƒì´ ì¥ì ì´ë‹¤.

```bash
cat <<EOF > sample-deployment-recreate.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sample-deployment-recreate
spec:
  strategy:
    type: Recreate
  replicas: 3
  selector:
    matchLabels:
      app: sample-app
  template:
    metadata:
      labels:
        app: sample-app
    spec:
      containers:
        - name: nginx-container
          image: nginx:1.16
EOF
```

```bash
$ kubectl get all -o wide
NAME                                              READY   STATUS    RESTARTS   AGE   IP          NODE         NOMINATED NODE   READINESS GATES
pod/sample-deployment-recreate-845c7cc945-248kj   1/1     Running   0          19s   10.44.0.2   k8s-node01   <none>           <none>
pod/sample-deployment-recreate-845c7cc945-hmpth   1/1     Running   0          19s   10.44.0.1   k8s-node01   <none>           <none>
pod/sample-deployment-recreate-845c7cc945-z5j5b   1/1     Running   0          19s   10.36.0.1   k8s-node02   <none>           <none>

NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE   SELECTOR
service/kubernetes   ClusterIP   10.96.0.1    <none>        443/TCP   47h   <none>

NAME                                         READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS        IMAGES       SELECTOR
deployment.apps/sample-deployment-recreate   3/3     3            3           19s   nginx-container   nginx:1.16   app=sample-app

NAME                                                    DESIRED   CURRENT   READY   AGE   CONTAINERS        IMAGES       SELECTOR
replicaset.apps/sample-deployment-recreate-845c7cc945   3         3         3       19s   nginx-container   nginx:1.16   app=sample-app,pod-template-hash=845c7cc945


# ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
$ kubectl set image deployment sample-deployment-recreate nginx-container=nginx:1.17


# ë ˆí”Œë¦¬ì¹´ì…‹ ëª©ë¡ í‘œì‹œ(ë¦¬ì†ŒìŠ¤ ìƒíƒœ ë³€í™”ê°€ ìˆìœ¼ë©´ ê³„ì† ì¶œë ¥)
$ kubectget replicasets --watch
NAME                                    DESIRED   CURRENT   READY   AGE
sample-deployment-recreate-6c8bfc45d6   0         0         0       108s
sample-deployment-recreate-845c7cc945   3         3         3       3m13s
sample-deployment-recreate-6c8bfc45d6   0         0         0       112s
sample-deployment-recreate-845c7cc945   0         3         3       3m18s
sample-deployment-recreate-845c7cc945   0         3         3       3m18s
sample-deployment-recreate-845c7cc945   0         0         0       3m18s
sample-deployment-recreate-6c8bfc45d6   3         0         0       113s
sample-deployment-recreate-6c8bfc45d6   3         0         0       113s
sample-deployment-recreate-6c8bfc45d6   3         3         0       113s
sample-deployment-recreate-6c8bfc45d6   3         3         1       116s
sample-deployment-recreate-6c8bfc45d6   3         3         2       116s
sample-deployment-recreate-6c8bfc45d6   3         3         3       116s
```

### (b) RollingUpdate

> RollingUpdateëŠ” **ì—…ë°ì´íŠ¸ ì¤‘ì— ë™ì‹œì— ì •ì§€ ê°€ëŠ¥í•œ ìµœëŒ€ íŒŒë“œ ìˆ˜(maxUnavailable)ì™€ ì—…ë°ì´íŠ¸ ì¤‘ì— ë™ì‹œì— ìƒì„±í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ íŒŒë“œ ìˆ˜(maxSurge)ë¥¼ ì„¤ì •**ì´ ê°€ëŠ¥í•˜ë©°, ì´ ì„¤ì •ì„ ì‚¬ìš©í•˜ë©´ ì¶”ê°€ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ í•˜ê±°ë‚˜ ë§ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ì†Œë¹„í•˜ì§€ ì•Šê³  ë¹ ë¥´ê²Œ ì „í™˜í•˜ëŠ” ë“± ì—…ë°ì´íŠ¸ë¥¼ í•˜ë©´ì„œ ë™ì‘ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤. (maxUnavailableê³¼ maxSurge ê°’ì„ ëª¨ë‘ 0ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ì—†ë‹¤.)

```bash
cat <<EOF > sample-deployment-rollingupdate.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sample-deployment-rollingupdate
spec:
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 0
      maxSurge: 1
  replicas: 3
  selector:
    matchLabels:
      app: sample-app
  template:
    metadata:
      labels:
        app: sample-app
    spec:
      containers:
        - name: nginx-container
          image: nginx:1.16
EOF
```

```bash
# ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
$ kubectl set image deployment sample-deployment-rollingupdate nginx-container=nginx:1.17


# ë ˆí”Œë¦¬ì¹´ì…‹ ëª©ë¡ í‘œì‹œ(ë¦¬ì†ŒìŠ¤ ìƒíƒœ ë³€í™”ê°€ ìˆìœ¼ë©´ ê³„ì† ì¶œë ¥)
# maxUnavailable=0/maxSurge=1 ì„¤ì •ì˜ RollingUpdateì—ì„œëŠ” maxSurge ìˆ˜ë§Œí¼ ì¶”ê°€ ë ˆí”Œë¦¬ì¹´ ìˆ˜ë¥¼ ëŠ˜ë ¤ íŒŒë“œë¥¼ ì´ë™ì‹œí‚¨ë‹¤.
$ kubectl get replicasets --watch
NAME                                         DESIRED   CURRENT   READY   AGE
sample-deployment-rollingupdate-845c7cc945   3         0         0       0s
sample-deployment-rollingupdate-845c7cc945   3         0         0       0s
sample-deployment-rollingupdate-845c7cc945   3         3         0       0s
sample-deployment-rollingupdate-845c7cc945   3         3         1       1s
sample-deployment-rollingupdate-845c7cc945   3         3         2       1s
sample-deployment-rollingupdate-845c7cc945   3         3         3       2s
sample-deployment-rollingupdate-6c8bfc45d6   1         0         0       0s
sample-deployment-rollingupdate-6c8bfc45d6   1         0         0       0s
sample-deployment-rollingupdate-6c8bfc45d6   1         1         0       0s
sample-deployment-rollingupdate-6c8bfc45d6   1         1         1       2s
sample-deployment-rollingupdate-845c7cc945   2         3         3       37s
sample-deployment-rollingupdate-6c8bfc45d6   2         1         1       2s
sample-deployment-rollingupdate-845c7cc945   2         3         3       37s
sample-deployment-rollingupdate-6c8bfc45d6   2         1         1       2s
sample-deployment-rollingupdate-845c7cc945   2         2         2       37s
sample-deployment-rollingupdate-6c8bfc45d6   2         2         1       2s
sample-deployment-rollingupdate-6c8bfc45d6   2         2         2       3s
sample-deployment-rollingupdate-845c7cc945   1         2         2       38s
sample-deployment-rollingupdate-6c8bfc45d6   3         2         2       3s
sample-deployment-rollingupdate-845c7cc945   1         2         2       38s
sample-deployment-rollingupdate-6c8bfc45d6   3         2         2       3s
sample-deployment-rollingupdate-845c7cc945   1         1         1       38s
sample-deployment-rollingupdate-6c8bfc45d6   3         3         2       3s
sample-deployment-rollingupdate-6c8bfc45d6   3         3         3       5s
sample-deployment-rollingupdate-845c7cc945   0         1         1       40s
sample-deployment-rollingupdate-845c7cc945   0         1         1       40s
sample-deployment-rollingupdate-845c7cc945   0         0         0       40s


# maxUnavailable=1/maxSurge=0 ì„¤ì •ì„ ë³€ê²½í•˜ê³  RollingUpdateë¥¼ ì‹œì‘í•˜ë©´ maxUnavailable ìˆ˜ë§Œí¼ ì¶”ê°€ ë ˆí”Œë¦¬ì¹´ ìˆ˜ë¥¼ ê°ì†Œì‹œí‚¨ í›„ íŒŒë“œë¥¼ ì´ë™ì‹œí‚¨ë‹¤.
$ kubectl get replicasets --watch
NAME                                         DESIRED   CURRENT   READY   AGE
sample-deployment-rollingupdate-845c7cc945   3         0         0       0s
sample-deployment-rollingupdate-845c7cc945   3         0         0       0s
sample-deployment-rollingupdate-845c7cc945   3         3         0       0s
sample-deployment-rollingupdate-845c7cc945   3         3         1       1s
sample-deployment-rollingupdate-845c7cc945   3         3         2       2s
sample-deployment-rollingupdate-845c7cc945   3         3         3       2s
sample-deployment-rollingupdate-6c8bfc45d6   0         0         0       0s
sample-deployment-rollingupdate-6c8bfc45d6   0         0         0       0s
sample-deployment-rollingupdate-845c7cc945   2         3         3       19s
sample-deployment-rollingupdate-6c8bfc45d6   1         0         0       0s
sample-deployment-rollingupdate-845c7cc945   2         3         3       19s
sample-deployment-rollingupdate-845c7cc945   2         2         2       19s
sample-deployment-rollingupdate-6c8bfc45d6   1         0         0       0s
sample-deployment-rollingupdate-6c8bfc45d6   1         1         0       0s
sample-deployment-rollingupdate-6c8bfc45d6   1         1         1       1s
sample-deployment-rollingupdate-845c7cc945   1         2         2       20s
sample-deployment-rollingupdate-6c8bfc45d6   2         1         1       1s
sample-deployment-rollingupdate-845c7cc945   1         2         2       20s
sample-deployment-rollingupdate-845c7cc945   1         1         1       20s
sample-deployment-rollingupdate-6c8bfc45d6   2         1         1       1s
sample-deployment-rollingupdate-6c8bfc45d6   2         2         1       1s
sample-deployment-rollingupdate-6c8bfc45d6   2         2         2       2s
sample-deployment-rollingupdate-845c7cc945   0         1         1       21s
sample-deployment-rollingupdate-6c8bfc45d6   3         2         2       2s
sample-deployment-rollingupdate-845c7cc945   0         1         1       21s
sample-deployment-rollingupdate-6c8bfc45d6   3         2         2       2s
sample-deployment-rollingupdate-845c7cc945   0         0         0       21s
sample-deployment-rollingupdate-6c8bfc45d6   3         3         2       2s
sample-deployment-rollingupdate-6c8bfc45d6   3         3         3       4s
```

<br>

## ğŸ”” ìƒì„¸ ì—…ë°ì´íŠ¸ íŒŒë¼ë¯¸í„°

### (a) minReadySeconds(ìµœì†Œ ëŒ€ê¸° ì‹œê°„(ì´ˆ))

> íŒŒë“œê°€ Ready ìƒíƒœê°€ ëœ ë‹¤ìŒë¶€í„° ë””í”Œë¡œì´ë¨¼íŠ¸ ë¦¬ì†ŒìŠ¤ì—ì„œ íŒŒë“œ ê¸°ë™ì´ ì™„ë£Œë˜ì—ˆë‹¤ê³  íŒŒë‹¨(ë‹¤ìŒ íŒŒë“œì˜ êµì²´ê°€ ê°€ëŠ¥í•˜ë‹¤ê³  íŒë‹¨)í•˜ê¸°ê¹Œì§€ì˜ ìµœì†Œ ì‹œê°„(ì´ˆ)

### (b) revisionHistoryLimit(ìˆ˜ì • ë²„ì „ ê¸°ë¡ ì œí•œ)

> ë””í”Œë¡œì´ë¨¼íŠ¸ê°€ ìœ ì§€í•  ë ˆí”Œë¦¬ì¹´ì…‹ ìˆ˜, ë¡¤ë°±ì´ ê°€ëŠ¥í•œ ì´ë ¥ ìˆ˜

### (c) progressDeadlineSeconds(ì§„í–‰ ê¸°í•œ ì‹œê°„(ì´ˆ))

> Recreate/RollingUpdate ì²˜ë¦¬ íƒ€ì„ì•„ì›ƒ ì‹œê°„, íƒ€ì„ ì•„ì›ƒ ê¸°ê°„ì´ ê²½ê³¼í•˜ë©´ ìë™ìœ¼ë¡œ ë¡¤ë°±

```bash
cat <<EOF > sample-deployment-params.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sample-deployment-params
spec:
  minReadySeconds: 0
  revisionHistoryLimit: 2
  progressDeadlineSeconds: 3600
  replicas: 3
  selector:
    matchLabels:
      app: sample-app
  template:
    metadata:
      labels:
        app: sample-app
    spec:
      containers:
        - name: nginx-container
          image: nginx:1.16
EOF
```

<br>

## ğŸ”” ë””í”Œë¡œì´ë¨¼íŠ¸ ìŠ¤ì¼€ì¼ë§

> ë””í”Œë¡œì´ë¨¼íŠ¸ê°€ ê´€ë¦¬í•˜ëŠ” ë ˆí”Œë¦¬ì¹´ì…‹ì˜ ë ˆí”Œë¦¬ì¹´ ìˆ˜ëŠ” ë ˆí”Œë¦¬ì¹´ì…‹ê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ kubectl apply -f ë˜ëŠ” kubectl scaleì„ ì‚¬ìš©í•˜ì—¬ ìŠ¤ì¼€ì¼í•  ìˆ˜ ìˆë‹¤.

```bash
# ë ˆí”Œë¦¬ì¹´ ìˆ˜ë¥¼ 3ì—ì„œ 4ë¡œ ë³€ê²½í•œ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ apply
$ sed -i -e 's|replicas: 3|replicas: 4|' sample-deployment.yaml

$ kubectl apply -f sample-deployment.yaml

# kubectl scale ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•œ ìŠ¤ì¼€ì¼ë§
$ kubectl scale deployment sample-deployment --replicas=5
```

<br>