---
title:  "[Docker] 14. Docker Compose ëª…ë ¹ì–´" 

categories:
  - DOCKER
tags:
  - [docker]

toc: true
toc_sticky: true

date: 2022-08-20
last_modified_at: 2022-08-20
---
# [Docker] 14. Docker Compose ëª…ë ¹ì–´
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
</style>

<br>

## ğŸ“œ Docker Composeì˜ ë²„ì „ í™•ì¸

```bash
$ docker-compose --version
```

<br>

## ğŸ“œ Docker Composeì˜ ê¸°ë³¸ ëª…ë ¹ì–´

<br>

|ì„œë¸Œ ëª…ë ¹|ì„¤ëª…|
|:---:|---|
|up|ì»¨í…Œì´ë„ˆ ìƒì„±/ì‹œì‘|
|ps|ì»¨í…Œì´ë„ˆ ëª©ë¡ í‘œì‹œ|
|logs|ì»¨í…Œì´ë„ˆ ë¡œê·¸ ì¶œë ¥|
|run|ì»¨í…Œì´ë„ˆ ì‹¤í–‰|
|start|ì»¨í…Œì´ë„ˆ ì‹œì‘|
|stop|ì»¨í…Œì´ë„ˆ ì •ì§€|
|restart|ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘|
|pause|ì»¨í…Œì´ë„ˆ ì¼ì‹œ ì •ì§€|
|unpause|ì»¨í…Œì´ë„ˆ ì¬ê°œ|
|port|ê³µê°œ í¬íŠ¸ ë²ˆí˜¸ í‘œì‹œ|
|config|êµ¬ì„± í™•ì¸|
|kill|ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ê°•ì œ ì •ì§€|
|rm|ì»¨í…Œì´ë„ˆ ì‚­ì œ|
|down|ë¦¬ì†ŒìŠ¤ ì‚­ì œ|

<br>

### (1) ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ìƒì„± - up

```bash
docker-compose up [ì˜µì…˜] [ì„œë¹„ìŠ¤ëª….]
```

|ì˜µì…˜|ì„¤ëª…|
|:---:|---|
|-d|ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰|
|-f|docker-compose.yml íŒŒì¼ì˜ ê²½ë¡œë¥¼ ì§€ì •|
|--no-deps|ì»¨í…Œì´ë„ˆ ëª©ë¡ í‘œì‹œ|
|--build|ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•¨|
|--no-build|ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ì§€ ì•ŠìŒ|
|-t, --timeout|ì»¨í…Œì´ë„ˆì˜ íƒ€ì„ì•„ì›ƒì„ ì´ˆë¡œ ì§€ì •(ê¸°ë³¸ê°’: 10s)í•¨|
|--scale SERVICE=ì„œë¹„ìŠ¤ ìˆ˜|ì„œë¹„ìŠ¤ ìˆ˜ë¥¼ ì§€ì •í•¨|

<br>

### (2) ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ í™•ì¸ - ps, logs

```bash
# ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆì˜ ìƒíƒœ í™•ì¸
$ docker-compose ps
  Name                  Command                             State       Ports
-----------------------------------------------------------------------------------
sample_server_a_1       nginx -g daemon off;                Up          80/tcp
sample_server_b_1       docker-entrypoint.sh redis...       Up          6379/tcp
```

```bash
# ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ID í™•ì¸
$ docker-compose ps -q
f2b9856d412af5b71f9062b8090a671625c4b8d1db547a80b6216ff5290b4b2b 
ff362c7e54ccbe37a499c577798e17964bc28c9ee02c163ff8e9a198251c05d0
```

```bash
# docker ëª…ë ¹ì„ ì‚¬ìš©í•œ ë¡œê·¸ í™•ì¸
$ docker-compose logs
Attaching to sample_server_b_1, sample_server_a_1
server_b_1 1: 12 Oct 04:55:40.944 # 0000000000000 Redis is starting c000000000000
server_b_1 1: 12 Oct 04:55:40.944 # Redis version 4.0.2, bits=64, commit=00000000, modified-0, pid=1, just started 
~ì¤‘ëµ~
```

<br>

### (3) ì»¨í…Œì´ë„ˆì—ì„œ ëª…ë ¹ ì‹¤í–‰ - run 

```bash
# server_aë¼ëŠ” ì»¨í…Œì´ë„ˆì—ì„œ /bin/bashë¥¼ ì‹¤í–‰
$ docker-compose run server_a /bin/bash
root@a68d85ef8707:/#
```

<br>

### (4) ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ì‹œì‘/ì •ì§€/ì¬ì‹œì‘ - start, stop, restart

```bash
# ì»¨í…Œì´ë„ˆ ì¼ê´„ ì‹œì‘/ì •ì§€/ì¬ì‹œì‘
$ docker-compose start 
Starting server_a ... done 
Starting server_b ... done

$ docker-compose stop
Stopping sample_server_b_1 ... done 
Stopping sample_server_a_1 ... done 

$ docker-compose restart
Restarting sample_server_b_1 ... done 
Restarting sample_server_a_1 ... done
```

```bash
# íŠ¹ì • ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
$ docker-compose restart server_a 
Restarting sample_server_a_1 ... done
```

<br>

### (5) ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ì¼ì‹œ ì •ì§€/ì¬ê°œ - pause, unpause

```bash
# ì»¨í…Œì´ë„ˆ ì¼ê´„ ì¼ì‹œ ì •ì§€/ì¬ê°œ
$ docker-compose pause
Pausing server_a ... done 
Pausing server_b ... done

$ docker-compose unpause
Unpausing sample_server_b_1 ... done 
Unpausing sample_server_a_1 ... done 
```

<br>

### (6) ì„œë¹„ìŠ¤ì˜ êµ¬ì„± í™•ì¸ - port, config

```bash
docker-compose port [ì˜µì…˜] <ì„œë¹„ìŠ¤ëª…> <í”„ë¼ì´ë¹— í¬íŠ¸ ë²ˆí˜¸>
```

|ì„œë¸Œ ëª…ë ¹|ì„¤ëª…|
|:---:|---|
|--protocol=proto|í”„ë¡œí† ì½œ, tcp ë˜ëŠ” udp|
|--index=index|ì»¨í…Œì´ë„ˆì˜ ì¸ë±ìŠ¤ ìˆ˜|

```bash
# ê³µê°œ í¬íŠ¸ í™•ì¸, webserverë¼ëŠ” ì´ë¦„ì˜ ì„œë¹„ìŠ¤ì˜ 80ë²ˆ í¬íŠ¸ì— í• ë‹¹ë˜ì–´ ìˆëŠ” ì„¤ì •ì„ í™•ì¸
$ docker-compose port webserver 80
0.0.0.0:80
```

```bash
# êµ¬ì„± í™•ì¸
$ docker-compose config
services:
    redis:
        image: redis 
    
    webserver:
        image: nginx
        ports:
            - 80:80/tcp
version: '3.9'
```

<br>

### (7) ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ê°•ì œ ì •ì§€/ì‚­ì œ - kill, rm

```bash
$ docker-compose kill -s SIGINT 
Killing sample_server_b_1 ... done
Killing sample_server_a_1 ... done
```

```bash
$ docker-compose rm
Going to remove sample_server_b_1, sample_server_a_1
Are you sure? [yN] y
Removing sample_server_b_1 ... done
Removing sample_server_a_1 ... done
```

<br>

### (8) ì—¬ëŸ¬ ë¦¬ì†ŒìŠ¤ì˜ ì¼ê´„ ì‚­ì œ - down

```bash
$ docker-compose down [ì˜µì…˜]
```

|ì˜µì…˜|ì„¤ëª…|
|:---:|---|
|--rmi all|ëª¨ë“  ì´ë¯¸ì§€ ì‚­ì œ|
|--rmi local|ì»¤ìŠ¤í…€ íƒœê·¸ê°€ ì—†ëŠ” ì´ë¯¸ì§€ë§Œ ì‚­ì œ|
|-v, --volumes|Compose ì •ì˜ íŒŒì¼ì˜ ë°ì´í„° ë³¼ë¥¨ì„ ì‚­ì œ|

```bash
$ docker-compose down --rmi all 
Stopping sample_webserver_1... done
Stopping sample_redis_1 ... done
Removing sample_webserver_1 ... done
Removing sample_redis_1 ... done
Removing network sample_default 
Removing image nginx
Removing image redis
```

<br>