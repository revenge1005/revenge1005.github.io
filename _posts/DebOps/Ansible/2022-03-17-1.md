---
title:  "[Ansible] 001. Ansible ì„¤ì¹˜" 

categories:
  - ANSIBLE
tags:
  - [ansible]

toc: true
toc_sticky: true

date: 2022-03-17
last_modified_at: 2022-03-17
---
# [Ansible] 001. Ansible ì„¤ì¹˜
---

<style>
table {
    font-size: 12pt;
}
table th:first-of-type {
    width: 5%;
}
table th:nth-of-type(2) {
    width: 15%;
}
table th:nth-of-type(3) {
    width: 50%;
}
table th:nth-of-type(4) {
    width: 30%;
}
</style>

## ğŸ”” ì‹œì‘í•˜ê¸° ì „ Ansibleì˜ ê°œë… ì²´í¬

- **[IaC] 04. Configuration ë„êµ¬ (2) - Ansible :** <https://revenge1005.github.io/iac/4/>

- **[IaC] 02. Configuration ë„êµ¬ì˜ ì£¼ìš” íŠ¹ì§• :** <https://revenge1005.github.io/iac/2/>

<br>

## ğŸ”” Ansible ì„¤ì¹˜

#### â“ Install Ansible 

```bash
# Ubuntu ë˜ëŠ” Debianì˜ ê²½ìš°
sudo apt update; sudo apt install software-properties-common -y
sudo add-apt-repository --yes --update ppa:ansible/ansible -y
sudo apt install ansible -y

# RHEL ë˜ëŠ” CentOSì˜ ê²½ìš°
dnf update -y; dnf install epel-release -y; dnf install ansible -y
ansible --version
```

<br>

#### â“‘ Managed ë…¸ë“œ -  ëŒ€ìƒ ì„œë²„ êµ¬ì„±

```bash
# Ubuntu ë˜ëŠ” Debianì˜ ê²½ìš°
apt install openssh-server -y
systemctl restart ssh; systemctl enable ssh
ufw allow 22

# RHEL ë˜ëŠ” CentOSì˜ ê²½ìš°
dnf install openssh-server -y
systemctl restart sshd; systemctl enable sshd
firewall-cmd --zone=public --permanent --add-port=22/tcp
```

<br>

#### â“’ Control ë…¸ë“œ -  SSH í‚¤ ìƒì„±
```bash
cat <<EOF >>/etc/hosts

# Control Node.
192.168.219.100  control  control.test.com
# Ansible Managed Nodes.
192.168.219.201  node01  node01.test.com
192.168.219.202  node02  node02.test.com
EOF

ssh-keygen -t ed25519 -C "Ansible Test"

ll .ssh/
í•©ê³„ 12
-rw------- 1 root root 399  5ì›”  4 16:41 id_ed25519
-rw-r--r-- 1 root root  94  5ì›”  4 16:41 id_ed25519.pub
-rw-r--r-- 1 root root 354  4ì›” 27 23:42 known_hosts


for i in node01 node02;
do
    ssh-copy-id -i ~/.ssh/id_ed25519.pub $i
done
```

<br>

#### â““ Control ë…¸ë“œ - ì¸ë²¤í† ë¦¬ ì‘ì„±

```bash
mkdir ansible_test
cd ansible_test

cat <<EOF > inventory
node01
node02
EOF

cat <<EOF > ansible.cfg
[defaults]
inventory = inventory
private_key_file = ~/.ssh/id_ed25519
EOF
```

<br>

#### â“” Control ë…¸ë“œ - ëª¨ë“  managed ë…¸ë“œ ping í…ŒìŠ¤íŠ¸

```bash
# ansible -m ping all
node02 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/libexec/platform-python"
    },
    "changed": false,
    "ping": "pong"
}
node01 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/libexec/platform-python"
    },
    "changed": false,
    "ping": "pong"
}
```

<br>

#### â“• Control ë…¸ë“œ -  Managed Node ìƒì„¸ ì •ë³´ í™•ì¸
```bash
## ëª¨ë“  ë…¸ë“œì— ëŒ€í•œ ìƒì„¸ ì •ë³´
ansible all -m gather_facts

## íŠ¹ì • ë…¸ë“œ ì§€ì •
ansible node01 -m gather_facts
ansible all -m gather_facts --limit node01
```

<br>